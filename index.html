<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Way of Code: Coding Yogi's Path</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;1,400&family=Inter:wght@300;400;500;600&family=Source+Code+Pro:wght@400;500&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3a 50%, #2d1b69 100%);
            color: #e6e6fa;
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative; 
            z-index: 1; 
        }
        
        header {
            padding: 2rem 0;
            text-align: center;
            position: relative;
            overflow: hidden; 
            min-height: 400px; 
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #three-js-canvas-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1; 
            background-color: transparent; 
        }
        
        .lotus-symbol {
            font-size: 4rem;
            animation: pulse 2s infinite alternate;
            display: inline-block;
            position: relative; 
            z-index: 1;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); color: #ffd700; }
            100% { transform: scale(1.05); color: #ffeb3b; }
        }
        
        h1 {
            font-family: 'Crimson Text', serif;
            font-size: 3.5rem;
            color: #4ecdc4;
            margin-top: 0.5rem;
            text-shadow: 0 0 15px rgba(78, 205, 196, 0.5);
            position: relative;
            z-index: 1;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #b0c4de;
            margin-top: 0.5rem;
            margin-bottom: 0.25rem; 
            position: relative;
            z-index: 1;
        }

        .header-tagline { 
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            color: #d8d8f0; /* Made slightly brighter */
            margin-top: 0.5rem; 
            position: relative;
            z-index: 1;
            font-style: italic;
            text-shadow: 0 1px 8px rgba(0,0,0,0.85), 0 0 3px rgba(0,0,0,0.7); /* Enhanced text shadow */
        }
        
        .hero-quote {
            font-family: 'Crimson Text', serif;
            font-size: 1.8rem;
            font-style: italic;
            color: #f0f8ff;
            margin: 2rem auto;
            max-width: 900px; 
            padding: 1.5rem;
            border-left: 5px solid #ffd700;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 1;
        }
        
        .hero-quote em {
            display: block;
            margin-top: 0.8rem;
            font-size: 1.4rem;
            color: #b0c4de;
        }
        
        .interactive-section {
            padding: 3rem 0;
        }
        
        .section-title {
            text-align: center;
            font-size: 2.5rem;
            color: #4ecdc4;
            margin-bottom: 2rem;
            text-shadow: 0 0 10px rgba(78, 205, 196, 0.3);
        }
        
        .wisdom-tabs {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        
        .tab-button {
            background: rgba(78, 205, 196, 0.2);
            color: #e6e6fa;
            border: 1px solid #4ecdc4;
            padding: 12px 25px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s ease, transform 0.3s ease, border-color 0.3s ease;
            font-weight: 500;
        }
        
        .tab-button:hover {
            background: rgba(78, 205, 196, 0.4);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(78, 205, 196, 0.2);
        }
        
        .tab-button.active {
            background: #4ecdc4;
            color: #0f0f23;
            border-color: #4ecdc4;
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(78, 205, 196, 0.4);
        }
        
        .tab-content {
            display: none;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 15px;
            margin: 1rem 0;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        
        .tab-content.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        
        .sub-navigation {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 2rem;
        }
        
        .sub-nav-button {
            background: rgba(255, 215, 0, 0.1);
            color: #ffd700;
            border: 1px solid #ffd700;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
            font-weight: 500;
        }
        
        .sub-nav-button:hover {
            background: rgba(255, 215, 0, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(255, 215, 0, 0.2);
            animation: pulse-small 0.5s infinite alternate; 
        }

        @keyframes pulse-small {
            0% { transform: scale(1); }
            100% { transform: scale(1.03); }
        }
        
        .sub-nav-button.active {
            background: #ffd700;
            color: #0f0f23;
            border-color: #ffd700;
            box-shadow: 0 3px 15px rgba(255, 215, 0, 0.4);
        }
        
        .content-section { /* Used for Gita Chapters and Sadhana subsections */
            display: none;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 15px;
            margin: 1rem auto;
            max-width: 1000px;
            box-shadow: 0 0 25px rgba(0, 0, 0, 0.4);
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out; 
        }
        
        .content-section.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        
        .chapter-content { /* Specific to Gita chapters, can be merged or kept */
            padding: 1.5rem;
        }
        
        .verse-sanskrit {
            font-family: 'Crimson Text', serif;
            font-size: 1.6rem;
            color: #b0c4de; /* Default color, can be overridden */
            margin-bottom: 0.5rem;
            text-align: center;
        }
        
        .verse-translation {
            font-family: 'Crimson Text', serif;
            font-size: 1.4rem;
            font-style: italic;
            color: #d1d1e0; /* Default color, can be overridden */
            margin-bottom: 1.5rem;
            text-align: center;
        }
        
        .programming-application, .practice-exercise { /* Shared by Gita and new Sadhana */
            background: rgba(0, 0, 0, 0.2);
            padding: 1.5rem;
            border-radius: 10px;
            margin-top: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
         /* Styling for new Sadhana interactive elements - adapted from inspiration */
        .sadhana-interactive-area .practice-exercise {
            background: rgba(255, 107, 107, 0.1); /* Inspiration's red-tinged practice */
            border-left: 4px solid #ff6b6b;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 10px 10px 0;
        }
        .sadhana-interactive-area .programming-application {
            background: rgba(15, 15, 35, 0.8); /* Inspiration's dark programming app */
            border: 1px solid #ffd700;
        }
        .sadhana-interactive-area .interactive-code { /* Re-use existing Gita interactive code style */
            margin-top: 1rem;
        }
        .sadhana-interactive-area .meditation-button { /* Inspiration style button */
            background: linear-gradient(45deg, #ffd700, #ff6b6b);
            border: none;
            padding: 0.8rem 1.5rem; /* Slightly smaller */
            border-radius: 50px;
            color: #0f0f23;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 1rem 0.5rem 0 0;
            font-size: 0.9rem;
        }
        .sadhana-interactive-area .meditation-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);
        }
         .sadhana-output { /* For interactive Sadhana button outputs */
            background: rgba(78, 205, 196, 0.1);
            color: #e6e6fa;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            font-family: 'Source Code Pro', monospace;
            font-size: 0.9rem;
            min-height: 40px;
            border: 1px dashed #4ecdc4;
        }


        .programming-application h4, .practice-exercise h4 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .interactive-code {
            font-family: 'Source Code Pro', monospace;
            background: #1a1a2e;
            color: #f8f8f2;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            border: 1px solid #4ecdc4;
            margin-bottom: 1rem;
            transition: border-color 0.3s ease, background-color 0.3s ease;
            white-space: pre; 
            font-size: 0.9rem; 
            line-height: 1.5; 
        }

        .interactive-code:hover {
            border-color: #ffd700; 
            background-color: #1e1e33;
        }
        
        .practice-button, .chapter-button { /* Gita chapter buttons */
            background: #4ecdc4;
            color: #0f0f23;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: background 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
            margin-top: 1rem;
            display: inline-block;
        }
        
        .chapter-button {
            background: #ff6b6b;
            color: #0f0f23;
            margin-left: 10px;
        }
        
        .practice-button:hover, .chapter-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .chapter-button:hover {
            background: #ff4d4d;
        }
        
        .code-editor-input {
            width: 100%;
            height: 100px;
            background: #0f0f23;
            border: 1px solid #4ecdc4;
            color: #e6e6fa;
            padding: 10px;
            border-radius: 8px;
            font-family: 'Source Code Pro', monospace;
            font-size: 0.9rem;
            margin-top: 1rem;
            resize: vertical;
        }
        
        .interactive-code-output, .challenge-output { 
            background: #0f0f23;
            color: #e6e6fa;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            font-family: 'Source Code Pro', monospace;
            font-size: 0.9rem;
            min-height: 50px;
            border: 1px dashed #b0c4de;
            transition: background-color 0.3s ease;
            white-space: pre-wrap; 
        }
        
        .floating-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }
        
        .floating-lotus {
            position: absolute;
            font-size: 3rem;
            color: rgba(255, 215, 0, 0.1);
            animation: float 10s infinite ease-in-out;
            transform: translateY(100vh);
        }
        
        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            50% { opacity: 0.5; }
            100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; }
        }
        
        /* Original Sadhana Grid - Will be hidden by new structure if JS works */
        .sadhana-grid { 
            /* display: grid; */ /* Let JS control display of new sadhana sections */
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }
        
        .sadhana-item { /* Original style, can be reused or adapted */
            background: rgba(0, 0, 0, 0.3);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease, border-color 0.3s ease;
            margin-bottom: 1rem; /* Added for spacing if used in new structure */
        }
        
        .sadhana-item:hover {
            transform: translateY(-5px);
            border-color: #ffd700;
        }
        
        .sadhana-item h4 { 
            color: #4ecdc4;
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
        }
        
        .sadhana-item p { 
            color: #d1d1e0;
            font-size: 0.95rem;
        }

        /* Styles for new Eightfold Path clickable items */
        .eightfold-item-clickable {
            background: rgba(0, 0, 0, 0.3);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            margin-bottom: 1rem; 
        }
        .eightfold-item-clickable h4 {
            color: #4ecdc4;
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .eightfold-item-clickable h4:hover {
            color: #ffd700;
        }
        .eightfold-description {
            color: #d1d1e0;
            font-size: 0.95rem;
            padding-top: 0.5rem;
            border-top: 1px solid rgba(255,255,255,0.1);
            margin-top: 0.5rem;
        }
        .eightfold-grid-clickable { 
             display: grid;
             grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
             gap: 1.5rem; 
        }


        .timer-display { /* General timer display, used by Sadhana timer now */
            text-align: center;
            margin-top: 1.5rem;
            font-size: 1.8rem;
            color: #ffd700;
            font-family: 'Source Code Pro', monospace;
            background: rgba(0, 0, 0, 0.4);
            padding: 1rem;
            border-radius: 10px;
            border: 1px solid #ffd700;
        }
        
        .timer-controls { /* General timer controls */
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 1.5rem;
        }
        
        .timer-controls button { /* General timer buttons, Sadhana uses .meditation-button */
            background: #ff6b6b;
            color: #0f0f23;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: background 0.3s ease, transform 0.3s ease;
        }
        
        .timer-controls button:hover {
            background: #ff4d4d;
            transform: translateY(-3px);
        }
        
        .challenge-card {
            background: rgba(0, 0, 0, 0.3);
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease;
        }
        
        .challenge-card:hover {
            transform: scale(1.02);
        }
        
        .challenge-card h4 {
            color: #ffd700;
            font-size: 1.4rem;
            margin-bottom: 0.8rem;
        }
        
        .challenge-card p {
            color: #d1d1e0;
            margin-bottom: 1rem;
        }
        
        .challenge-card pre {
            background: #1a1a2e;
            color: #f8f8f2;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Source Code Pro', monospace;
            font-size: 0.9rem;
            border: 1px solid #ffd700;
        }
        
        .run-challenge-button {
            background: #4ecdc4;
            color: #0f0f23;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: background 0.3s ease, transform 0.3s ease;
            margin-top: 1rem;
        }
        
        .run-challenge-button:hover {
            background: #3ac0b7;
            transform: translateY(-3px);
        }
        
        footer {
            text-align: center;
            padding: 2rem 0;
            color: #b0c4de;
            font-size: 0.9rem;
            margin-top: 3rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        @media (max-width: 768px) {
            h1 { font-size: 2.5rem; }
            .hero-quote { font-size: 1.5rem; }
            .tab-button, .sub-nav-button { font-size: 0.9rem; padding: 10px 20px; }
            .content-section { padding: 1.5rem; }
            .verse-sanskrit { font-size: 1.4rem; }
            .verse-translation { font-size: 1.2rem; }
            .programming-application, .practice-exercise { padding: 1rem; }
            .sadhana-grid, .eightfold-grid-clickable { grid-template-columns: 1fr; }
        }
        
        @media (max-width: 480px) {
            h1 { font-size: 2rem; }
            .hero-quote { font-size: 1.2rem; padding: 1rem; }
            .tab-button { width: 100%; }
            .sub-navigation { flex-direction: column; align-items: center; }
            .sub-nav-button { width: 80%; }
        }
    </style>
</head>
<body>
    <div class="floating-elements" id="floatingElements"></div>

    <div class="container">
        <header>
            <div id="three-js-canvas-container"></div>
            <div class="lotus-symbol">🪷</div>
            <h1>The Way of Code</h1>
            <p class="subtitle">Coding Yogi's Path</p>
            <p class="header-tagline">Inspired by the Ancient wisdom of Sri Bhagavad Gita</p> 
            <div class="hero-quote">
                "योगः कर्मसु कौशलम्" <br>
                <em>"Yoga is skill in action"</em> — Bhagavad Gita 2.50
            </div>
        </header>

        <section class="interactive-section">
            <h2 class="section-title">Sacred Learning Paths</h2>

            <div class="wisdom-tabs">
                <button class="tab-button active" onclick="showTab('sadhana', event)">The Developer's Daily Sadhana</button>
                <button class="tab-button" onclick="showTab('eightfold', event)">Eightfold Path of Programming</button>
                <button class="tab-button" onclick="showTab('programmer-gita', event)">The Programmer's Gita</button>
                <button class="tab-button" onclick="showTab('code-challenges', event)">Code Challenges</button>
            </div>

            <div id="sadhana" class="tab-content active">
                <div class="sub-navigation">
                    <button class="sub-nav-button active" onclick="showSadhanaSubSection('sadhana_morning', event)">Morning Rituals</button>
                    <button class="sub-nav-button" onclick="showSadhanaSubSection('sadhana_deep_work', event)">Deep Work / Meditation</button>
                    <button class="sub-nav-button" onclick="showSadhanaSubSection('sadhana_learning_service', event)">Learning & Service</button>
                    <button class="sub-nav-button" onclick="showSadhanaSubSection('sadhana_mindful_living', event)">Mindful Living</button>
                    <button class="sub-nav-button" onclick="showSadhanaSubSection('sadhana_timer', event)">Sacred Timer</button>
                </div>

                <div id="sadhana_morning" class="content-section active sadhana-interactive-area">
                    <h3 style="color: #ffd700; margin-bottom: 1.5rem;">🌅 Morning Rituals & Intention</h3>
                    <div class="sadhana-item"> <h4>ब्रह्म मुहूर्त कोडिंग (Early Morning Coding)</h4>
                        <p>Starting your day with focused coding, when the mind is fresh and distractions are minimal. This is your most productive and meditative time.</p>
                    </div>
                    <div class="practice-exercise">
                        <h4 style="color: #ff6b6b;">The Developer's Dawn Prayer</h4>
                        <p>"Before I touch the keyboard, I pause. Before I open the IDE, I breathe. Before I write the first line, I ask: What is my intention today?"</p>
                        <div class="verse-sanskrit" style="color:#ffd700;">ॐ सर्वे भवन्तु सुखिनः</div>
                        <div class="verse-translation" style="color:#d1d1e0;">"Om, May all beings be happy." (Set an intention for positive impact)</div>
                    </div>
                    <div class="programming-application">
                        <h4 style="color: #4ecdc4;">Daily Coding Intentions</h4>
                        <p style="color: #d1d1e0; line-height: 1.8;">Choose one intention for your coding session today:</p>
                        <ul style="color: #d1d1e0; list-style-type: disc; margin-left: 20px;">
                            <li>Clarity: "May my code be clear and understandable."</li>
                            <li>Service: "May this work benefit users and the broader community."</li>
                            <li>Learning: "May I approach challenges with a curious and open mind."</li>
                            <li>Patience: "May I meet bugs and complexities with calm perseverance."</li>
                        </ul>
                        <button class="meditation-button" onclick="handleSadhanaInteraction('intentionOutput', 'Daily intention set. Carry this awareness into your code.')">Set Today's Intention</button>
                        <div id="intentionOutput" class="sadhana-output"></div>
                    </div>
                </div>

                <div id="sadhana_deep_work" class="content-section sadhana-interactive-area">
                    <h3 style="color: #ffd700; margin-bottom: 1.5rem;">🧘🏽‍♀️ Deep Work & Debugging Meditations</h3>
                     <div class="sadhana-item">
                        <h4>ध्यान (Meditation / Deep Work)</h4>
                        <p>Engaging in uninterrupted, deep work sessions. Minimize notifications, focus intently on one task, and enter a flow state, treating it as a form of active meditation.</p>
                    </div>
                    <div class="practice-exercise">
                        <h4 style="color: #ff6b6b;">The Bug as Teacher</h4>
                        <p>"Every bug is a messenger. Every error is a teacher. Every stack trace is a path to deeper understanding. Frustration is optional; learning is inevitable."</p>
                         <div class="verse-sanskrit" style="color:#ffd700;">असतो मा सद्गमय</div>
                        <div class="verse-translation" style="color:#d1d1e0;">"Lead me from the unreal (buggy state) to the real (correct state)."</div>
                    </div>
                     <div class="programming-application">
                        <h4 style="color: #4ecdc4;">Mindful Debugging Steps</h4>
                        <ol style="color: #d1d1e0; list-style-type: decimal; margin-left: 20px;">
                            <li>**Acknowledge:** "A wild bug appears!" Accept its presence calmly.</li>
                            <li>**Breathe:** Take three conscious breaths. Detach from initial frustration.</li>
                            <li>**Observe:** Gather data. Read error messages fully. Reproduce consistently.</li>
                            <li>**Hypothesize:** Form a clear idea of the cause. "What if...?"</li>
                            <li>**Test:** Verify your hypothesis with minimal, targeted changes or logging.</li>
                            <li>**Iterate:** If wrong, form a new hypothesis. Each attempt is learning.</li>
                        </ol>
                        <button class="meditation-button" onclick="handleSadhanaInteraction('debugOutput', 'Debugging meditation started. Approach with calm, focused inquiry.')">Begin Debugging Meditation</button>
                        <div id="debugOutput" class="sadhana-output"></div>
                    </div>
                </div>

                <div id="sadhana_learning_service" class="content-section sadhana-interactive-area">
                     <h3 style="color: #ffd700; margin-bottom: 1.5rem;">📚 Continuous Learning (Svadhyaya) & Service (Seva)</h3>
                     <div class="sadhana-item">
                        <h4>स्वध्याय (Self-Study / Learning)</h4>
                        <p>Dedicate time daily or weekly to continuous learning: reading documentation, exploring new technologies, studying algorithms, or reviewing best practices. Never stop evolving your craft and understanding.</p>
                    </div>
                     <div class="sadhana-item">
                        <h4>सेवा (Service / Open Source)</h4>
                        <p>Contribute to open-source projects, mentor junior developers, or help colleagues. Use your skills for the benefit of the wider community without expectation of direct reward. This purifies intention and expands perspective.</p>
                    </div>
                    <div class="practice-exercise">
                        <h4 style="color: #ff6b6b;">Knowledge as Offering</h4>
                        <p>"The code I learn today, I share tomorrow. The problem I solve for myself, I document for others. My growth serves the whole."</p>
                    </div>
                </div>
                
                <div id="sadhana_mindful_living" class="content-section sadhana-interactive-area">
                    <h3 style="color: #ffd700; margin-bottom: 1.5rem;">🌿 Mindful Living for Coders</h3>
                     <div class="sadhana-item">
                        <h4>कर्म योग (Detached Action)</h4>
                        <p>Code with full effort and dedication, but remain unattached to the outcome (success or failure of the project, praise or criticism). Focus on the quality of your work and the integrity of your process.</p>
                    </div>
                     <div class="sadhana-item">
                        <h4>आहार (Mindful Consumption)</h4>
                        <p>Be mindful of what you "consume": not just food, but information, entertainment, and social media. Choose inputs that nourish your mind and body, not distract or drain them. This affects your coding clarity.</p>
                    </div>
                     <div class="sadhana-item">
                        <h4>प्रकृति संरक्षण (Environmental Stewardship)</h4>
                        <p>Consider the environmental impact of your code and infrastructure. Strive for energy-efficient solutions and sustainable practices in development. Code with respect for the planet.</p>
                    </div>
                    <div class="sadhana-item">
                        <h4>निद्रा (Restful Sleep)</h4>
                        <p>Prioritize adequate and restful sleep. A well-rested mind is essential for clarity, creativity, and effective problem-solving. Treat sleep as a sacred part of your sadhana.</p>
                    </div>
                     <div class="practice-exercise">
                        <h4 style="color: #ff6b6b;">Evening Code Reflection & Gratitude</h4>
                        <p>"As the day's coding ends, I review my actions, not just my code. What did I learn? How did I serve? For what am I grateful in my coding journey today?"</p>
                        <button class="meditation-button" onclick="handleSadhanaInteraction('reflectionOutput', 'Evening reflection started. Contemplate your day\'s coding karma.')">Begin Evening Reflection</button>
                        <div id="reflectionOutput" class="sadhana-output"></div>
                    </div>
                </div>

                <div id="sadhana_timer" class="content-section sadhana-interactive-area">
                    <h3 style="color: #ffd700; margin-bottom: 1.5rem;">⏰ Sacred Coding Timer</h3>
                    <div class="meditation-timer"> <h4 style="color: #4ecdc4;">Mindful Coding Sessions</h4>
                        <div class="timer-display" id="timerDisplaySadhana">00:00:00</div> <div class="timer-controls">
                            <button id="startTimerButtonSadhana" class="meditation-button" onclick="startSadhanaTimer()">Start Focus</button>
                            <button id="pauseTimerButtonSadhana" class="meditation-button" onclick="pauseSadhanaTimer()" disabled>Pause Focus</button>
                            <button id="resetTimerButtonSadhana" class="meditation-button" onclick="resetSadhanaTimer()" disabled>Reset Focus</button>
                        </div>
                        <p style="color: #d1d1e0; margin-top: 1rem;">Use this timer for focused coding sessions (e.g., Pomodoro) or mindful breaks.</p>
                        <div class="verse-sanskrit" style="color:#ffd700;">कालोऽस्मि लोकक्षयकृत्प्रवृद्धो</div>
                        <div class="verse-translation" style="color:#d1d1e0;">"I am Time, the great destroyer of worlds, and I have come here to destroy all people." (BG 11.32) - Use time consciously.</div>
                    </div>
                </div>
            </div>

            <div id="eightfold" class="tab-content">
                <h3 style="color: #ffd700; margin-bottom: 1.5rem; text-align:center;">🛤️ The Eightfold Path of Programming</h3>
                <div class="eightfold-grid-clickable">
                    <div class="eightfold-item-clickable">
                        <h4 onclick="toggleDescription(this, 'eightfoldDesc1')">1. सम्यक् संकल्प (Right Intention) <span class="toggle-icon">➕</span></h4>
                        <div class="eightfold-description" id="eightfoldDesc1" style="display:none;">
                            <p>Before writing a single line of code, clearly define your purpose and intention. Is it to solve a real problem? To build something robust and useful? To simplify complexity?</p>
                        </div>
                    </div>
                    <div class="eightfold-item-clickable">
                        <h4 onclick="toggleDescription(this, 'eightfoldDesc2')">2. सम्यक् स्मृति (Right Mindfulness) <span class="toggle-icon">➕</span></h4>
                        <div class="eightfold-description" id="eightfoldDesc2" style="display:none;">
                            <p>Be fully present while coding. Pay attention to detail, understand the current state of the system, and be aware of potential side effects or implications of your changes.</p>
                        </div>
                    </div>
                    <div class="eightfold-item-clickable">
                        <h4 onclick="toggleDescription(this, 'eightfoldDesc3')">3. सम्यक् आजीव (Right Livelihood) <span class="toggle-icon">➕</span></h4>
                        <div class="eightfold-description" id="eightfoldDesc3" style="display:none;">
                            <p>Ensure your work aligns with ethical principles. Avoid projects that cause harm, infringe on privacy, or promote injustice. Use your skills for positive impact.</p>
                        </div>
                    </div>
                    <div class="eightfold-item-clickable">
                        <h4 onclick="toggleDescription(this, 'eightfoldDesc4')">4. सम्यक् व्यायाम (Right Effort) <span class="toggle-icon">➕</span></h4>
                        <div class="eightfold-description" id="eightfoldDesc4" style="display:none;">
                            <p>Put in consistent, focused effort. Don't procrastinate, but also don't overwork. Balance intense coding sprints with periods of rest and recovery. Strive for mastery, not just completion.</p>
                        </div>
                    </div>
                    <div class="eightfold-item-clickable">
                        <h4 onclick="toggleDescription(this, 'eightfoldDesc5')">5. सम्यक् दृष्टि (Right Understanding) <span class="toggle-icon">➕</span></h4>
                        <div class="eightfold-description" id="eightfoldDesc5" style="display:none;">
                            <p>Understand the problem domain, the underlying technologies, and the architectural patterns deeply. Don't just copy-paste solutions; comprehend why they work.</p>
                        </div>
                    </div>
                    <div class="eightfold-item-clickable">
                        <h4 onclick="toggleDescription(this, 'eightfoldDesc6')">6. सम्यक् वाक् (Right Speech/Communication) <span class="toggle-icon">➕</span></h4>
                        <div class="eightfold-description" id="eightfoldDesc6" style="display:none;">
                            <p>Communicate clearly and concisely in code (comments, variable names), in documentation, and with your team. Avoid jargon, ambiguity, and unnecessary complexity.</p>
                        </div>
                    </div>
                    <div class="eightfold-item-clickable">
                        <h4 onclick="toggleDescription(this, 'eightfoldDesc7')">7. सम्यक् कर्मान्त (Right Action) <span class="toggle-icon">➕</span></h4>
                        <div class="eightfold-description" id="eightfoldDesc7" style="display:none;">
                            <p>Write clean, testable, and maintainable code. Practice good version control, participate in code reviews, and strive for elegant solutions that are easy to understand and extend.</p>
                        </div>
                    </div>
                    <div class="eightfold-item-clickable">
                        <h4 onclick="toggleDescription(this, 'eightfoldDesc8')">8. सम्यक् समाधि (Right Concentration/Flow) <span class="toggle-icon">➕</span></h4>
                        <div class="eightfold-description" id="eightfoldDesc8" style="display:none;">
                            <p>Achieve a state of deep concentration (flow state) where you are fully immersed in the coding task. This leads to highly productive and creative output, a meditative experience.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="programmer-gita" class="tab-content">
                <div class="sub-navigation">
                    <button class="sub-nav-button active" onclick="showGitaChapter(1, event)">Ch 1</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(2, event)">Ch 2</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(3, event)">Ch 3</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(4, event)">Ch 4</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(5, event)">Ch 5</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(6, event)">Ch 6</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(7, event)">Ch 7</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(8, event)">Ch 8</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(9, event)">Ch 9</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(10, event)">Ch 10</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(11, event)">Ch 11</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(12, event)">Ch 12</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(13, event)">Ch 13</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(14, event)">Ch 14</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(15, event)">Ch 15</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(16, event)">Ch 16</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(17, event)">Ch 17</button>
                    <button class="sub-nav-button" onclick="showGitaChapter(18, event)">Ch 18</button>
                </div>

                <div id="chapter1" class="content-section active">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 1: The Coder's Dilemma (अर्जुन विषाद योग)</h3>
                        <div class="verse-sanskrit">धर्मक्षेत्रे कुरुक्षेत्रे समवेता युयुत्सवः</div>
                        <div class="verse-translation">"In the field of dharma, in the field of code, assembled and ready to program..."</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">The Modern Arjuna's Dilemma</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">Like Arjuna facing his kinsmen, every programmer faces ethical dilemmas: choosing between a quick, dirty fix and a long-term, maintainable solution; prioritizing profit over user well-being; or navigating conflicts between personal values and project requirements. This chapter acknowledges the inner conflict and confusion that often precedes true action.</p>
                            <div class="interactive-code" id="arjunaDilemmaCode">// Chapter 1: The Coder's Dilemma (Arjuna Vishada Yoga)
// Arjuna, the skilled warrior (coder), faces a moral crisis
// before the great battle (a challenging project or ethical choice).

class ProjectDilemma {
    constructor(projectName, ethicalConcerns, technicalDebtConcerns) {
        this.projectName = projectName; // The "battlefield"
        this.ethicalConcerns = ethicalConcerns; // Moral conflicts, user impact
        this.technicalDebtConcerns = technicalDebtConcerns; // Quick fixes vs. sustainability
        this.coderConfusion = true; // Arjuna's initial state of despair
        this.chosenPath = null;
    }

    // Function to evaluate paths based on guiding principles (Dharma)
    evaluateOptions(optionA_Compromise, optionB_PrincipledStand) {
        console.log(`[Dilemma] Evaluating options for ${this.projectName}:`);
        console.log("Option A (Potential Adharma):", optionA_Compromise.description);
        console.log("Option B (Path of Dharma):", optionB_PrincipledStand.description);

        // The inner struggle: short-term ease vs. long-term integrity
        if (this.coderConfusion) {
            console.log("Coder feels overwhelmed, unsure of the right action...");
            // This is where the guidance of the Gita (wisdom) is needed.
        }

        // Conceptual decision based on prioritizing Dharma (long-term well-being, ethics)
        // This is a simplified representation; true Dharma requires deep introspection.
        if (optionB_PrincipledStand.alignsWithDharma && 
            optionB_PrincipledStand.longTermBenefit > optionA_Compromise.shortTermGain) {
            this.chosenPath = optionB_PrincipledStand;
            console.log(`[Dharma Decision] Path chosen: ${this.chosenPath.description} for ${this.projectName}.`);
        } else {
            this.chosenPath = optionA_Compromise; // Illustrates a potential fall to adharma or compromise
            console.log(`[Compromise] Path chosen: ${this.chosenPath.description}. Consequences to be faced.`);
        }
        this.coderConfusion = false; // Clarity sought, even if decision is tough.
        return this.chosenPath;
    }
}

// Example: A coder faces a dilemma on "Project Kurukshetra"
const projectKurukshetra = new ProjectDilemma(
    "Project Kurukshetra - Client X Feature",
    ["User privacy concerns if rushed", "Potential for dark patterns"],
    ["Pressure to ship fast creating massive tech debt"]
);

const quickFix = { 
    description: "Implement feature quickly, ignore ethical edge cases, accrue tech debt.",
    shortTermGain: 10, // e.g., meets deadline
    alignsWithDharma: false,
    longTermBenefit: 2
};

const ethicalSolution = {
    description: "Push back for more time, build ethically, ensure maintainability.",
    shortTermGain: 3,  // e.g., slightly delayed
    alignsWithDharma: true,
    longTermBenefit: 10
};

// To simulate in console:
// projectKurukshetra.evaluateOptions(quickFix, ethicalSolution);
// This sets the stage for seeking higher wisdom, like Arjuna does.
</div>
                            <button class="practice-button" onclick="runConceptualCode('arjunaDilemmaCode')">Simulate Dilemma</button>
                            <div id="arjunaDilemmaOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">Reflection Exercise</h4>
                            <p>Think of a recent ethical dilemma you faced in your coding or work. How did you resolve it? Could you have approached it differently, guided by principles of dharma?</p>
                            <textarea id="dilemmaReflectionInput" class="code-editor-input" placeholder="Describe your dilemma..."></textarea>
                            <button class="chapter-button" onclick="recordDilemma()">Record My Dilemma</button>
                            <div id="dilemmaReflectionOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                
                <div id="chapter2" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 2: The Eternal Code (सांख्य योग)</h3>
                        <div class="verse-sanskrit">नासतो विद्यते भावो नाभावो विद्यते सतः</div>
                        <div class="verse-translation">"The temporary has no reality; the eternal never ceases to be"</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">Eternal Principles in Code</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">Technologies, frameworks, and languages constantly change, but certain fundamental principles of computation, logic, and good engineering (like abstraction, modularity, efficiency, readability) remain eternal. Focus on understanding these timeless concepts rather than getting lost in the fleeting trends of the temporary.</p>
                            <div class="interactive-code" id="eternalCode">// Chapter 2: The Eternal Code (Sankhya Yoga)
// Distinguishing the temporary (asat) from the eternal (sat) in programming.

// Temporary Aspects (Asat) - Constantly changing, specific implementations
class TemporaryFramework {
    constructor(name, version, specificSyntax) {
        this.name = name; // e.g., "React", "Angular", "Vue", "jQuery"
        this.version = version; // e.g., "18.0", "1.0", "beta-XYZ"
        this.specificSyntax = specificSyntax; // e.g., "this.setState()", "useEffect()", "$('.class')"
        console.log(`[Temporary] Framework ${name} v${version} initialized. Syntax: ${specificSyntax}`);
    }

    // Specific methods tied to this temporary framework
    renderUI_frameworkSpecific() {
        console.log(`[Temporary] Rendering UI using ${this.name}'s specific methods.`);
        // ... code that will likely change when framework evolves or is replaced
    }
}

// Eternal Principles (Sat) - Timeless concepts, underlying truths
class EternalCodingPrinciples {
    constructor() {
        // These principles are language/framework agnostic
        this.modularity = "Build with independent, reusable components.";
        this.abstraction = "Hide complex implementation details behind simple interfaces.";
        this.readability = "Write code that is easy for humans to understand.";
        this.efficiency = "Optimize for resource usage (time, memory) where it matters.";
        this.dataStructures = "Understand how to organize data effectively (arrays, lists, trees, graphs).";
        this.algorithms = "Master fundamental problem-solving patterns (sorting, searching).";
        console.log("[Eternal] Core coding principles established.");
    }

    // Applying eternal principles, regardless of temporary tools
    applyToProject(project, frameworkInstance) {
        console.log(`[Eternal] Applying timeless principles to project: ${project.name}`);
        console.log(` - Ensuring Modularity: ${this.modularity}`);
        // Example: Even if using frameworkInstance.specificSyntax, the overall architecture is modular.
        
        console.log(` - Striving for Readability: ${this.readability}`);
        // Example: Clear variable names, comments, logical flow, independent of framework.
        
        if (frameworkInstance) {
            console.log(` - Using ${frameworkInstance.name} as a tool, not as the sole identity of the solution.`);
        }
    }
}

// To simulate in console:
// const currentTrendyFramework = new TemporaryFramework("FluxCapacitor.js", "0.9-alpha", "flux.capacitor.engage()");
// This framework might be gone in 2 years.
// const myCodingPhilosophy = new EternalCodingPrinciples();
// These principles will remain valuable throughout a coder's career.
// const myProject = { name: "TimelessApp" };
// myCodingPhilosophy.applyToProject(myProject, currentTrendyFramework);

// The Gita teaches that the soul (Atman) is eternal, like these principles.
// The body (physical tools, frameworks) is temporary.
// Focus on the eternal for lasting wisdom and skill.
</div>
                            <button class="practice-button" onclick="runConceptualCode('eternalCode')">Simulate Eternal Focus</button>
                            <div id="eternalCodeOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">Eternal Coding Meditation</h4>
                            <p>What principles guide your programming that transcend any specific technology or framework? How do you apply them consistently?</p>
                            <textarea id="eternalPrinciplesInput" class="code-editor-input" placeholder="List your eternal principles..."></textarea>
                            <button class="chapter-button" onclick="identifyEternalPrinciples()">Identify My Eternal Principles</button>
                            <div id="eternalPrinciplesOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                <div id="chapter3" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 3: Karma Yoga Programming (कर्म योग)</h3>
                        <div class="verse-sanskrit">कर्मण्येवाधिकारस्ते मा फलेषु कदाचन</div>
                        <div class="verse-translation">"You have the right to perform action, but not to the fruits of action"</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">Detached Programming</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">Focus on writing the best possible code, solving the problem with dedication and skill, but without excessive attachment to the outcome – whether it becomes a huge success, gets refactored next month, or receives specific praise. Your duty is the action; the results are not entirely within your control. This minimizes stress and enhances pure creativity.</p>
                            <div class="interactive-code" id="karmaYogaCode">// Chapter 3: Karma Yoga - The Art of Detached Action in Coding

// -- The Path of Detached Action (Karma Yoga) --
function performWorkWithSkillAndDetachment(task) {
    console.log(`[Karma Yoga] Starting task: '${task.title}' with focused effort.`);

    // 1. Understand the requirements (Right Understanding - connected to Samyak Drishti)
    const understanding = analyzeTaskRequirements(task.details);
    console.log("[Karma Yoga] Task requirements analyzed. Clarity achieved.");

    // 2. Perform the action (coding) with full dedication and skill
    // Treat the act of coding itself as an offering.
    let codeSolution = developFeature(understanding, { qualityFocus: "high", dedication: "full" });
    codeSolution = ensureCodeQuality(codeSolution); // Includes testing, refactoring for clarity.
    console.log("[Karma Yoga] Code developed and quality ensured to the best of ability.");

    // 3. Offer the work (e.g., submit pull request) without attachment to specific outcomes
    submitWorkForReview(codeSolution, task.id);
    console.log(`[Karma Yoga] Task '${task.title}' completed and submitted. Action performed, outcome is not my primary concern.`);
    console.log("[Karma Yoga] Focus remains on the quality of action, dedication to duty, not personal praise or blame.");

    // Renounce the fruits: Avoid anxiously awaiting validation or specific results.
    // Instead, move to the next righteous action, learning, or mindful rest.
    // Example of what NOT to do (action with attachment):
    // while(true) { anxiouslyCheckMergeStatus(); countLikesOnCommit(); seekPraiseFromLead(); }
    return "Action performed in the spirit of Karma Yoga.";
}

// -- Helper conceptual functions for illustration --
function analyzeTaskRequirements(details) {
    // Simulates deep analysis of the task
    return { ...details, understood: true };
}

function developFeature(understanding, params) {
    // Simulates the coding process with specified focus
    console.log(`[Karma Yoga] Developing with params:`, params);
    return `/* ... well-crafted code based on ${JSON.stringify(understanding)} ... */`;
}

function ensureCodeQuality(code) {
    // Simulates testing, linting, peer review input etc.
    return code + "\n// Quality checks passed.";
}

function submitWorkForReview(code, taskId) {
    // Simulates submitting the code
    console.log(`[Karma Yoga] Submitting code for task ID: ${taskId}.`);
}

// -- Contrast: Action with Attachment (Not Karma Yoga) --
function performWorkWithAttachmentAndExpectation(task) {
    console.log(`[Attachment] Starting task: '${task.title}', hoping for a promotion!`);
    
    let codeSolution = developFeature(task.details, { qualityFocus: "sufficient_for_deadline", dedication: "partial_with_distractions" });
    
    submitWorkForReview(codeSolution, task.id);
    console.log(`[Attachment] Submitted! Anxiously awaiting feedback. This must succeed!`);

    let approvalStatus = "pending";
    let stressLevel = 5;
    // Simulating anxious waiting and emotional reaction to outcomes
    // This loop represents the mental state of attachment.
    /*
    while(approvalStatus !== "approvedAndPraised") {
        approvalStatus = checkReviewStatusObsessively(); // Conceptual
        if (approvalStatus === "criticized") {
            stressLevel += 3;
            console.log(`[Attachment] Oh no, criticism! Stress: ${stressLevel}. My career is over!`);
        } else if (approvalStatus === "minor_changes_requested") {
            stressLevel += 1;
            console.log(`[Attachment] More work? Stress: ${stressLevel}.`);
        } else if (approvalStatus === "approvedAndPraised") {
            console.log(`[Attachment] YES! Approved and Praised! Temporary happiness! Stress drops to 0 (for now).`);
        }
    }
    */
    return "Action performed with attachment, leading to potential stress and emotional volatility.";
}

// To simulate in console:
// const importantFeatureTask = { id: "FT-101", title: "Implement Core User Authentication", details: { /* ... */ } };
// performWorkWithSkillAndDetachment(importantFeatureTask);
// performWorkWithAttachmentAndExpectation(importantFeatureTask);
</div>
                            <button class="practice-button" onclick="runConceptualCode('karmaYogaCode')">Simulate Karma Yoga</button>
                            <div id="karmaYogaOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">Karma Yoga Challenge</h4>
                            <p>For one week, practice detached programming. Choose a task, give it your full effort, and upon completion, mentally release attachment to its fate. Observe how this affects your stress levels and enjoyment.</p>
                            <textarea id="karmaYogaChallengeInput" class="code-editor-input" placeholder="Reflect on your Karma Yoga experience..."></textarea>
                            <button class="chapter-button" onclick="startKarmaYogaChallenge()">Begin Challenge</button>
                            <div id="karmaYogaChallengeOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                <div id="chapter4" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 4: Divine Knowledge in Code (ज्ञान कर्म संन्यास योग)</h3>
                        <div class="verse-sanskrit">यदा यदा हि धर्मस्य ग्लानिर्भवति भारत</div>
                        <div class="verse-translation">"Whenever dharma declines and adharma rises, I manifest to restore balance"</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">The Avatar Principle in Code</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">Just as divine consciousness manifests to restore dharma, conscious programmers emerge when technological 'adharma' (e.g., privacy invasion, algorithmic bias, malicious software) rises. Your skill and knowledge are tools to restore balance, build ethical systems, and serve true progress. View yourself as an agent of positive change.</p>
                            <div class="interactive-code" id="avatarCode">// Chapter 4: Divine Knowledge in Code (Jnana Karma Sannyasa Yoga)
// The "Avatar Principle": When digital adharma (unethical tech) rises,
// knowledgeable and ethical programmers (Avatars of Dharma) emerge to restore balance.

class DigitalAdharmaDetector {
    constructor() {
        this.knownAdharmicPatterns = [
            { id: "DA001", name: "Algorithmic Bias", description: "System unfairly disadvantages certain groups." },
            { id: "DA002", name: "Privacy Invasion", description: "Excessive data collection without consent." },
            { id: "DA003", name: "Dark Patterns", description: "UI designed to trick users." },
            { id: "DA004", name: "Security Vulnerabilities", description: "Negligence leading to data breaches." },
            { id: "DA005", name: "Misinformation Amplification", description: "Systems promoting false narratives." }
        ];
    }

    scanSystem(systemCode, systemBehavior) {
        console.log("[Avatar] Scanning system for signs of digital adharma...");
        const issuesFound = [];
        this.knownAdharmicPatterns.forEach(pattern => {
            // Conceptual: In a real scenario, this would involve complex analysis.
            if (systemCode.includes(`exploit_${pattern.id}`) || (systemBehavior && systemBehavior.shows && systemBehavior.shows(pattern.name))) {
                console.warn(`[Avatar] Potential Adharma detected: ${pattern.name} - ${pattern.description}`);
                issuesFound.push(pattern);
            }
        });
        if (issuesFound.length === 0) {
            console.log("[Avatar] System appears to be in line with Dharma (ethical principles).");
        }
        return issuesFound;
    }
}

class EthicalProgrammer { // The "Avatar"
    constructor(name, skills, jnanaLevel) {
        this.name = name; // e.g., "Arjuna of Code"
        this.skills = skills; // e.g., ["Secure Coding", "Ethical AI", "UX Design"]
        this.jnanaLevel = jnanaLevel; // Level of divine knowledge/wisdom
        this.mission = "To uphold Dharma in the digital realm.";
        console.log(`[Avatar] Ethical Programmer ${this.name} activated. Mission: ${this.mission}`);
    }

    // Action (Karma) guided by Knowledge (Jnana) and Renunciation of selfish motives (Sannyasa)
    restoreDigitalDharma(adharmaIssues, systemToFix) {
        if (adharmaIssues.length === 0) {
            console.log("[Avatar] No adharma to correct at this time. Vigilance maintained.");
            return;
        }
        console.log(`[Avatar] ${this.name} commencing mission to restore Dharma for ${adharmaIssues.length} issues.`);
        
        adharmaIssues.forEach(issue => {
            console.log(`[Avatar] Addressing: ${issue.name}. Applying knowledge and skills...`);
            // Conceptual: Applying specific skills to fix the issue
            switch(issue.id) {
                case "DA001": // Algorithmic Bias
                    systemToFix.refactorAlgorithm("fairness_principles");
                    console.log(`[Avatar] Corrected algorithmic bias by refactoring with fairness principles.`);
                    break;
                case "DA002": // Privacy Invasion
                    systemToFix.implementDataMinimization();
                    systemToFix.enhanceConsentMechanisms();
                    console.log(`[Avatar] Mitigated privacy invasion through data minimization and enhanced consent.`);
                    break;
                // ... other cases
                default:
                    console.log(`[Avatar] Developing novel solution for ${issue.name}.`);
            }
        });
        console.log(`[Avatar] Dharma restoration efforts completed for ${systemToFix.name}. The system is now more balanced.`);
        // This action is a form of "Yajna" (sacrifice/offering) for the good of all.
    }
}

// To simulate in console:
// const adharmaScanner = new DigitalAdharmaDetector();
// const systemInQuestion = { 
//     name: "SocialNetVortex",
//     code: "exploit_DA001; exploit_DA003;", 
//     behavior: { shows: (patternName) => patternName === "Algorithmic Bias" || patternName === "Dark Patterns" },
//     refactorAlgorithm: (principle) => console.log(`  System: Algorithm refactored based on ${principle}.`),
//     implementDataMinimization: () => console.log("  System: Data minimization implemented."),
//     enhanceConsentMechanisms: () => console.log("  System: Consent mechanisms enhanced.")
// };
// const detectedIssues = adharmaScanner.scanSystem(systemInQuestion.code, systemInQuestion.behavior);
// if (detectedIssues.length > 0) {
//     const consciousCoder = new EthicalProgrammer("DharmaWarrior", ["Ethical AI", "Secure UX"], 10);
//     consciousCoder.restoreDigitalDharma(detectedIssues, systemInQuestion);
// }
// The "Avatar" acts not for personal glory, but for cosmic balance (Loka-Sangraha).
</div>
                            <button class="practice-button" onclick="runConceptualCode('avatarCode')">Simulate Avatar Mission</button>
                            <div id="avatarCodeOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">Avatar Mission Discovery</h4>
                            <p>Identify a technological imbalance that disturbs you. How could your programming skills be used to bring balance or a more ethical approach to that area?</p>
                            <textarea id="avatarMissionInput" class="code-editor-input" placeholder="Describe your avatar mission..."></textarea>
                            <button class="chapter-button" onclick="discoverAvatarMission()">Discover My Mission</button>
                            <div id="avatarMissionOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                <div id="chapter5" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 5: The Yoga of Renunciation of Action (कर्मसंन्यासयोग)</h3>
                        <div class="verse-sanskrit">संन्यासः कर्मयोगश्च निःश्रेयसकरावुभौ</div>
                        <div class="verse-translation">"Renunciation of action and action in devotion both lead to liberation"</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">Letting Go of Code (and Ownership)</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">The liberated programmer understands when to refactor (renounce old code), when to delete (complete renunciation of a feature no longer serving purpose), and when to contribute without attachment to ownership (action in devotion, sharing your code freely). Code flows through us, not from us alone; it's a shared creation.</p>
                            <div class="interactive-code" id="renunciationCode">// Chapter 5: The Yoga of Renunciation of Action (Karma Sannyasa Yoga)
// Understanding that true liberation comes from renouncing attachment to actions and their fruits,
// even while performing actions skillfully (Karma Yoga).

class CodeLifecycleManager {
    constructor(coderEgoLevel) {
        this.coderEgoLevel = coderEgoLevel; // High ego = attachment to "my code"
        this.projectCodebase = {
            "featureA.js": { lines: 200, author: "self", status: "legacy", used: false, quality: "low" },
            "moduleB.py": { lines: 500, author: "team", status: "active", used: true, quality: "medium" },
            "utilityC.go": { lines: 50, author: "self", status: "new_idea", used: false, potential: "high_for_community" }
        };
    }

    // Sannyasa in Action: Renouncing outdated/unused code
    evaluateCodeForDeletion(filePath) {
        const file = this.projectCodebase[filePath];
        if (!file) return "File not found.";

        console.log(`[Renunciation] Evaluating '${filePath}' (authored by ${file.author}).`);
        if (!file.used && file.status === "legacy") {
            if (this.coderEgoLevel > 7 && file.author === "self") {
                console.log(`  [Ego] Hesitation: "But *I* wrote this! It was brilliant once!"`);
                return "Decision clouded by ego attachment. Renunciation difficult.";
            } else {
                console.log(`  [Wisdom] This code, though once useful, no longer serves. Time to renounce it for project health.`);
                // delete this.projectCodebase[filePath]; // Conceptually deleting
                return `'${filePath}' renounced (deleted) for the greater good of the project.`;
            }
        }
        return `'${filePath}' is still in use or not legacy. Renunciation not applicable yet.`;
    }

    // Karma Yoga in Action: Contributing selflessly without ownership claims
    contributeToOpenSource(contributionDetails) {
        const { moduleName, code, intent } = contributionDetails;
        console.log(`[Selfless Action] Preparing contribution: '${moduleName}'. Intent: ${intent}.`);

        if (this.coderEgoLevel > 5) {
            console.log(`  [Ego] "Hope I get lots of stars and recognition for *my* brilliant contribution!"`);
            // Motivation is mixed with desire for personal fruit.
        } else {
            console.log(`  [Detachment] "Offering this code to the community. May it be useful. Its fate is not my prime concern."`);
            // Motivation is closer to pure service.
        }
        // Simulating the contribution
        // openSourcePlatform.submit(moduleName, code, { authorAnonymity: this.coderEgoLevel < 3 });
        return `Contribution '${moduleName}' offered. Practice of Karma Sannyasa involves detaching from 'authorship' pride.`;
    }

    // True Sannyasa is not inactivity, but renunciation of attachment *while* acting.
    performActionsWithInnerRenunciation() {
        console.log("\n[True Sannyasa] Performing necessary actions with inner detachment:");
        // Example: Refactoring a module written by someone else (Karma Yoga without ego of "improving OTHERS' code")
        this.projectCodebase["moduleB.py"].lines += 10; // Conceptual refactor
        console.log("  - Refactored 'moduleB.py' for clarity and efficiency (Karma Yoga).");
        
        // Example: Mentoring a junior developer (Action in devotion - Bhakti Yoga element)
        console.log("  - Mentored junior_dev on 'utilityC.go' (Sharing knowledge selflessly).");
        
        console.log("All actions performed skillfully, without selfish attachment to outcomes or egoistic ownership.");
    }
}

// To simulate in console:
// const attachedCoder = new CodeLifecycleManager(8); // High ego
// console.log("--- Simulating Coder with High Ego Attachment ---");
// attachedCoder.evaluateCodeForDeletion("featureA.js");
// attachedCoder.contributeToOpenSource({ moduleName: "MyEgoBoosterLib", code: "//...", intent: "get_famous" });

// console.log("\n--- Simulating Coder Practicing Renunciation & Detached Action ---");
// const sannyasiCoder = new CodeLifecycleManager(3); // Low ego, practices detachment
// sannyasiCoder.evaluateCodeForDeletion("featureA.js");
// sannyasiCoder.contributeToOpenSource({ moduleName: "HelpfulUtility", code: "//...", intent: "serve_community" });
// sannyasiCoder.performActionsWithInnerRenunciation();

// The Gita teaches that Karma Sannyasa Yoga (renunciation in action) and Karma Yoga (selfless action)
// both lead to liberation. The key is the internal state of detachment.
</div>
                            <button class="practice-button" onclick="runConceptualCode('renunciationCode')">Simulate Renunciation</button>
                            <div id="renunciationCodeOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">Renunciation Reflection</h4>
                            <p>Think about a piece of code you are hesitant to change or delete, even though it might be necessary for the project's health. What attachments are you holding onto? Can you practice "letting go"?</p>
                            <textarea id="renunciationReflectionInput" class="code-editor-input" placeholder="Reflect on your attachments to code..."></textarea>
                            <button class="chapter-button" onclick="reflectOnRenunciation()">Reflect on Renunciation</button>
                            <div id="renunciationReflectionOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                <div id="chapter6" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 6: The Yoga of Meditation (ध्यानयोग)</h3>
                        <div class="verse-sanskrit">युक्ताहारविहारस्य युक्तचेष्टस्य कर्मसु</div>
                        <div class="verse-translation">"Yoga is attained by those who are temperate in eating and recreation, regulated in their actions, and balanced in sleep and wakefulness."</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">The Meditative Coder</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">Deep work requires focus and a balanced state. Just as meditation stills the mind, conscious coding requires minimizing distractions, finding flow, and taking regular, restorative breaks. The ideal coding session is a form of active meditation, where the mind is absorbed in the problem, yet aware and balanced.</p>
                            <div class="interactive-code" id="dhyanaCode">// Chapter 6: The Yoga of Meditation (Dhyana Yoga)
// Achieving a meditative state (Flow State) in coding through discipline and practice.

class MeditativeCodingSession {
    constructor(coder, task) {
        this.coder = coder; // Object with properties like 'mindState', 'focusLevel'
        this.task = task;   // Object describing the coding task
        this.environment = {}; // To store environment settings
        this.sessionLog = [];
        this.flowStateAchieved = false;
    }

    // Yukta-ahara-viharasya: Regulated habits are foundational
    prepareCoderForMeditation() {
        this.log("Preparing coder: Ensuring adequate rest, balanced 'consumption' (info, food).");
        if (!this.coder.isWellRested || this.coder.isOverstimulated) {
            this.log("Coder not in optimal state for Dhyana. Recommend balancing activities first.");
            return false;
        }
        this.coder.mindState = "calm_and_prepared";
        return true;
    }

    // Setting up the "Asana" (seat) for coding meditation
    setupDistractionFreeEnvironment() {
        this.log("Setting up environment for Dhyana (Deep Work):");
        this.environment.notifications = "silenced";
        this.environment.workspace = "clean_and_organized";
        this.environment.tools_ready = true; // IDE, docs, etc.
        this.log(`  - Notifications: ${this.environment.notifications}`);
        this.log(`  - Workspace: ${this.environment.workspace}`);
        this.log("Environment conducive to single-pointed focus.");
    }

    // Ekagram Manah Kritva: Making the mind one-pointed
    focusOnTask(task) {
        this.log(`Focusing mind (Ekagram Manah) on the single task: ${task.description}`);
        this.coder.currentFocus = task;
        this.coder.focusLevel = 0; // Start focusing
        // Gradually increase focus, withdraw from external thoughts
        for (let i = 1; i <= 10; i++) {
            this.coder.focusLevel = i;
            // this.log(`  Focus intensity: ${i}/10`);
        }
        this.log("Mind established in the task. External distractions fade.");
    }

    // Entering Samadhi / Flow State
    enterFlowState() {
        if (this.coder.focusLevel >= 9 && this.coder.mindState === "calm_and_prepared") {
            this.log(">>> FLOW STATE (Samadhi in Action) ACHIEVED <<<");
            this.log("    Time perception may alter. Deep immersion in the task.");
            this.log("    Problem-solving becomes intuitive. Code flows effortlessly.");
            this.flowStateAchieved = true;
            // Conceptual: Actual coding happens here, with high productivity and creativity.
            this.task.solution = `// ...elegant and efficient code for ${this.task.description} manifested...`;
            this.log(`    Task '${this.task.description}' completed with high quality in Flow State.`);
        } else {
            this.log("Flow State not achieved. Review preparation and focus.");
        }
    }

    // Concluding the session, returning to normal awareness
    concludeSession() {
        this.log("Dhyana coding session concluding.");
        if (this.flowStateAchieved) {
            this.log("Emerging from Flow State with clarity and a sense of accomplishment.");
        }
        this.coder.focusLevel = 0;
        this.coder.mindState = "peaceful_and_aware";
        this.log("Remember to take a mindful break. (Yukta Vihara)");
    }

    log(message) {
        this.sessionLog.push(message);
        console.log(`[DhyanaYoga] ${message}`);
    }

    run() {
        if (!this.prepareCoderForMeditation()) return;
        this.setupDistractionFreeEnvironment();
        this.focusOnTask(this.task);
        this.enterFlowState();
        this.concludeSession();
    }
}

// To simulate in console:
// const developer = { name: "Yogi Coder", isWellRested: true, isOverstimulated: false };
// const complexAlgorithmTask = { id: "T101", description: "Design a novel pathfinding algorithm" };
// const codingMeditation = new MeditativeCodingSession(developer, complexAlgorithmTask);
// codingMeditation.run();
// The Gita emphasizes control of the mind and senses for true meditation.
</div>
                            <button class="practice-button" onclick="runConceptualCode('dhyanaCode')">Simulate Mindful Coding</button>
                            <div id="dhyanaCodeOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">Meditation in Code Challenge</h4>
                            <p>For your next coding session, consciously apply principles of meditation: focus, presence, and detachment from distractions. Observe how it affects your productivity and mental state.</p>
                            <textarea id="dhyanaChallengeInput" class="code-editor-input" placeholder="Reflect on your mindful coding session..."></textarea>
                            <button class="chapter-button" onclick="startDhyanaChallenge()">Begin Dhyana Challenge</button>
                            <div id="dhyanaChallengeOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                <div id="chapter7" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 7: The Yoga of Knowledge and Wisdom (ज्ञानविज्ञानयोग)</h3>
                        <div class="verse-sanskrit">भूमिरापोऽनलो वायुः खं मनो बुद्धिरेव च</div>
                        <div class="verse-translation">"Earth, water, fire, air, ether, mind, and intellect—these are the eightfold divisions of My material nature."</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">Understanding the Layers of Technology</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">True mastery comes from understanding the fundamental layers of technology, from the "earth" of hardware to the "ether" of networks, and the "mind" of algorithms. Superficial knowledge of frameworks is insufficient; seek the underlying wisdom of how systems truly operate, from physics to logic.</p>
                            <div class="interactive-code" id="jnanaCode">// Chapter 7: The Yoga of Knowledge (Jnana) and Realization (Vijnana)
// Understanding the fundamental "material nature" (Prakriti) of technology.

class TechPrakriti { // The "Material Nature" of a software system
    constructor() {
        // These are analogous to the Gita's elements:
        this.hardware = "[Earth] Physical servers, CPUs, RAM, storage. The solid foundation.";
        this.os_kernel = "[Water] Operating system, kernel. Manages resources, flow of execution.";
        this.power_network = "[Fire] Electricity, network infrastructure (cables, routers). Energy and data transfer.";
        this.protocols_comms = "[Air] TCP/IP, HTTP, APIs. Communication medium, invisible but vital.";
        this.cloud_virtualization = "[Ether/Space] Abstract layers, VMs, containers. Pervasive, seemingly boundless.";
        
        // Higher elements, more subtle:
        this.data_structures_logic = "[Mind (Manas)] How data is organized and basic logic flows. Processing faculty.";
        this.algorithms_architecture = "[Intellect (Buddhi)] Complex problem-solving, design patterns, system architecture. Discriminative faculty.";
        this.user_intent_purpose = "[Ego (Ahankara - in its role as 'I-maker' of the system's purpose)] The 'why' behind the system, its intended identity and function.";
        
        console.log("[JnanaYoga] TechPrakriti: The 8-fold nature of a software system defined.");
    }

    displayLayers() {
        console.log("  Layer 1 (Gross): Hardware - " + this.hardware);
        console.log("  Layer 2 (Gross): OS/Kernel - " + this.os_kernel);
        console.log("  Layer 3 (Subtle): Power/Network - " + this.power_network);
        console.log("  Layer 4 (Subtle): Protocols/Comms - " + this.protocols_comms);
        console.log("  Layer 5 (Most Subtle): Cloud/Virtualization - " + this.cloud_virtualization);
        console.log("  Layer 6 (Internal Faculty): Data/Logic (Mind) - " + this.data_structures_logic);
        console.log("  Layer 7 (Internal Faculty): Algorithms/Architecture (Intellect) - " + this.algorithms_architecture);
        console.log("  Layer 8 (Internal Faculty): Purpose/Intent (Ego-function) - " + this.user_intent_purpose);
    }
}

class SoftwareSage { // A programmer with Jnana (knowledge) and Vijnana (realized wisdom)
    constructor(prakritiKnowledge) {
        this.prakriti = prakritiKnowledge; // Knowledge of the underlying layers
        console.log("[JnanaYoga] Software Sage initialized with deep knowledge of TechPrakriti.");
    }

    diagnoseProblem(symptom, surfaceLayerFramework) {
        console.log(`\n[Sage] Diagnosing symptom: "${symptom}" appearing in framework: ${surfaceLayerFramework.name}.`);
        console.log("[Sage] Superficial approach: Blame the framework, look for quick config fix.");
        
        console.log("[Sage] Jnana-Vijnana approach: Consider all layers of Prakriti.");
        // Example: A slow web request
        if (symptom === "Slow API Response") {
            console.log("  - Checking Cloud/Virtualization (Ether): Any platform issues? Resource limits?");
            console.log("  - Checking Protocols/Comms (Air): Network latency? API gateway bottlenecks?");
            console.log("  - Checking Power/Network (Fire): Server load? Database connection pool exhaustion?");
            console.log("  - Checking OS/Kernel (Water): High CPU/memory on server? I/O waits?");
            console.log("  - Checking Hardware (Earth): Failing disk? Insufficient server specs?");
            console.log("  - Checking Algorithms/Architecture (Intellect): Inefficient database query? Poorly designed microservice interaction?");
            console.log("  - Checking Data/Logic (Mind): Incorrect data transformation causing retries?");
            
            // Vijnana (Realization): The sage understands the interconnectedness.
            // A problem manifesting at the "framework level" (a higher abstraction)
            // often has its roots in a more fundamental layer of the TechPrakriti.
            console.log("[Sage] Conclusion: Found bottleneck in database query (Intellect layer) affecting network (Air) and perceived at framework.");
            return "Root cause identified by understanding the full stack (Prakriti).";
        }
        return "Symptom not recognized for this conceptual diagnosis.";
    }
}

// To simulate in console:
// const techLayers = new TechPrakriti();
// techLayers.displayLayers();
// const sageCoder = new SoftwareSage(techLayers);
// const superficialFramework = { name: "ShinyUI.js v3.0" };
// sageCoder.diagnoseProblem("Slow API Response", superficialFramework);

// The Gita teaches that understanding Prakriti (material nature) and Purusha (Spirit/Consciousness)
// is key to liberation. For a coder, understanding the 'Prakriti' of technology deeply is Jnana.
// Applying this knowledge to solve problems effectively and ethically is Vijnana.
</div>
                            <button class="practice-button" onclick="runConceptualCode('jnanaCode')">Reflect on Layers</button>
                            <div id="jnanaCodeOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">Knowledge Seeking</h4>
                            <p>Identify one fundamental technology (e.g., TCP/IP, the principles of relational databases, how a CPU works) that you don't fully understand. Make a commitment to learn its core concepts this week, going beyond surface-level usage.</p>
                            <textarea id="jnanaReflectionInput" class="code-editor-input" placeholder="My knowledge-seeking goal..."></textarea>
                            <button class="chapter-button" onclick="setJnanaGoal()">Set Knowledge Goal</button>
                            <div id="jnanaReflectionOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                <div id="chapter8" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 8: The Yoga of the Imperishable Brahman (अक्षरब्रह्मयोग)</h3>
                        <div class="verse-sanskrit">अक्षरं ब्रह्म परमं स्वभावोऽध्यात्ममुच्यते</div>
                        <div class="verse-translation">"The imperishable, transcendental living entity is called Brahman, and his eternal nature is called the self."</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">The Essence of Code</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">Beneath the ever-changing syntax and paradigms lies the unchanging essence of computation: logic, information flow, and transformation. Focus on these "imperishable" principles that underpin all coding languages and systems. This understanding allows you to adapt to any new technology without losing your core competence.</p>
                            <div class="interactive-code" id="aksharaCode">// Chapter 8: The Yoga of the Imperishable Brahman (Akshara Brahma Yoga)
// Understanding the "Akshara" (imperishable, unchanging) principles in coding.

// Specific, perishable implementation of a function (e.g., in JavaScript ES5)
function calculateSum_ES5(arr) {
    var sum = 0;
    for (var i = 0; i < arr.length; i++) {
        sum += arr[i];
    }
    console.log("[Perishable Syntax] Sum (ES5):", sum);
    return sum;
}

// Another perishable implementation (e.g., Python)
/*
def calculate_sum_python(arr):
    s = 0
    for x in arr:
        s += x
    print("[Perishable Syntax] Sum (Python):", s)
    return s
*/

// The Akshara (Imperishable) Principle: The Algorithm/Logic
class ImperishableAlgorithm {
    constructor(name, description, coreLogicSteps) {
        this.name = name; // e.g., "Summation Algorithm"
        this.description = description; // "Calculates the sum of elements in a collection."
        this.coreLogicSteps = coreLogicSteps; // Language-agnostic steps
        console.log(`[Akshara] Imperishable Algorithm Defined: ${this.name}`);
        console.log(`  Description: ${this.description}`);
        this.coreLogicSteps.forEach((step, index) => {
            console.log(`  Core Logic Step ${index + 1}: ${step}`);
        });
    }

    // This core logic can be expressed in any (perishable) language/syntax.
    visualizeExecution(sampleData) {
        console.log(`\n[Akshara] Visualizing execution of '${this.name}' with data: [${sampleData.join(', ')}]`);
        let accumulator = 0; // Step 1: Initialize accumulator
        console.log(`  1. Initialize accumulator to 0. (Current: ${accumulator})`);
        
        // Step 2: Iterate through each element
        sampleData.forEach((element, index) => {
            console.log(`  2.${index + 1}. Processing element: ${element}`);
            // Step 3: Add element to accumulator
            accumulator += element;
            console.log(`     3. Add element to accumulator. (Current: ${accumulator})`);
        });
        // Step 4: Result is the final value of the accumulator
        console.log(`  4. Final result (accumulator): ${accumulator}`);
        return accumulator;
    }
}

// To simulate in console:
// const summationAlgorithm = new ImperishableAlgorithm(
//     "Summation Algorithm",
//     "Calculates the total sum of elements in a given numerical collection.",
//     [
//         "Initialize an accumulator variable to zero.",
//         "For each element in the collection:",
//         "  Add the current element's value to the accumulator.",
//         "The final value of the accumulator is the sum."
//     ]
// );
// const dataArray = [10, 20, 30, 40];
// console.log("\n--- Demonstrating Perishable Implementations ---");
// calculateSum_ES5(dataArray); // JavaScript ES5 syntax (perishable)
// console.log("\n--- Demonstrating the Imperishable Core Logic ---");
// summationAlgorithm.visualizeExecution(dataArray);

// The Gita teaches that Brahman (the Absolute) is Akshara (imperishable).
// Similarly, the core logic/algorithms are the 'Akshara' of code.
// Syntaxes, languages, frameworks are 'Kshara' (perishable) forms.
// Focusing on the Akshara principles gives lasting skill and understanding.
</div>
                            <button class="practice-button" onclick="runConceptualCode('aksharaCode')">Contemplate Essence</button>
                            <div id="aksharaCodeOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">Finding the Core</h4>
                            <p>Choose a coding problem you recently solved. Strip away the specific language and libraries you used. Can you describe the core algorithm or logical steps in a language-agnostic way? How does this reveal the "imperishable" aspect of your solution?</p>
                            <textarea id="aksharaReflectionInput" class="code-editor-input" placeholder="Describe the core logic..."></textarea>
                            <button class="chapter-button" onclick="reflectOnCoreLogic()">Reflect on Core Logic</button>
                            <div id="aksharaReflectionOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                <div id="chapter9" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 9: The Yoga of the King of Knowledge, the King of Secrets (राजविद्याराजगुह्ययोग)</h3>
                        <div class="verse-sanskrit">मयि सर्वमिदं प्रोतं सूत्रे मणिगणा इव</div>
                        <div class="verse-translation">"All this universe is pervaded by Me in My unmanifested form, just as pearls are strung on a thread."</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">The Interconnectedness of Code</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">Every piece of code, every module, every service is interconnected, forming a larger system. Understanding these relationships and the underlying architecture is the "king of knowledge." The subtle ways these parts interact, often hidden from plain sight, are the "king of secrets." True wisdom comes from perceiving this pervasive interconnectedness.</p>
                            <div class="interactive-code" id="rajaVidyaCode">// Chapter 9: The King of Knowledge (Raja Vidya), King of Secrets (Raja Guhyam)
// Understanding the all-pervading, unifying principle (the "Sutra" or thread)
// that connects all parts of a complex software system.

class SoftwareSystemPearls {
    constructor(name, unifyingSutraDescription) {
        this.systemName = name;
        this.modules = {}; // Individual "pearls" (modules, services)
        this.unifyingSutra = unifyingSutraDescription; // The "Sutra" or thread
        console.log(`[RajaVidya] System '${this.systemName}' established. Unifying Sutra: '${this.unifyingSutra}'.`);
    }

    addPearl(moduleName, dependencies, functionalities) {
        this.modules[moduleName] = {
            name: moduleName,
            dependencies: dependencies, // Other modules it depends on
            functionalities: functionalities, // What it does
            state: "idle"
        };
        console.log(`  Added Module (Pearl): '${moduleName}'.`);
    }

    // This is the "Raja Guhyam" - the secret of how everything is connected
    // by the "Sutra" (unifying principle).
    traceInterconnections(initiatingModule, action) {
        console.log(`\n[RajaGuhyam] Tracing action '${action}' initiated by '${initiatingModule}':`);
        let currentModule = this.modules[initiatingModule];
        if (!currentModule) {
            console.error("  Error: Initiating module not found.");
            return;
        }

        console.log(`  1. '${currentModule.name}' performs action: '${action}'. State: 'processing'.`);
        currentModule.state = "processing";
        const affectedModules = new Set([initiatingModule]); // Track affected modules to avoid redundant logging or infinite loops in complex traces

        // Simulate cascading effect based on dependencies and unifying principle
        // The "unifyingPrinciple" (e.g., data flow) dictates how these interactions happen.
        const traceDependencies = (modName, depth = 0) => {
            const mod = this.modules[modName];
            if (!mod || depth > 5) return; // Limit recursion depth for demo

            (mod.dependencies || []).forEach(depName => {
                const dependentModule = this.modules[depName];
                if (dependentModule && !affectedModules.has(depName)) {
                     affectedModules.add(depName);
                    console.log(`${'    '.repeat(depth + 1)}-> Due to '${this.unifyingSutra}', '${modName}' interacts with '${depName}'.`);
                    dependentModule.state = "triggered_by_" + modName;
                    console.log(`${'    '.repeat(depth + 2)}'${depName}' state: '${dependentModule.state}'. It might perform its own actions.`);
                    traceDependencies(depName, depth + 1); // Recursive call for deeper dependencies
                }
            });
        };
        
        traceDependencies(initiatingModule);
        console.log(`  Action trace complete. All modules are interconnected through the '${this.unifyingSutra}'.`);
        // Reset states for conceptual clarity
        Object.values(this.modules).forEach(m => m.state = "idle");
    }

    // The "King of Knowledge" is to perceive this Sutra.
    perceiveTheUnifyingSutra() {
        console.log(`\n[RajaVidya] The King of Knowledge for system '${this.systemName}':`);
        console.log(`  All modules (pearls): ${Object.keys(this.modules).join(', ')}`);
        console.log(`  Are strung on the Unifying Principle (Sutra): '${this.unifyingSutra}'.`);
        console.log("  Understanding this interconnectedness is key to mastering the system.");
        console.log("  Changes in one pearl (module) can affect the entire string (system) via the Sutra.");
    }
}

// To simulate in console:
// const eCommercePlatform = new SoftwareSystemPearls("MegaMart Online", "Event-Driven Data Synchronization");
// eCommercePlatform.addPearl("AuthService", ["LoggingService"], ["UserLogin"]);
// eCommercePlatform.addPearl("ProductCatalog", ["DatabaseService", "LoggingService"], ["ListProducts"]);
// eCommercePlatform.addPearl("OrderProcessing", ["ProductCatalog", "PaymentGateway", "InventoryService", "LoggingService"], ["PlaceOrder"]);
// eCommercePlatform.addPearl("PaymentGateway", ["BankAPI", "LoggingService"], ["ProcessPayment"]);
// eCommercePlatform.addPearl("InventoryService", ["DatabaseService", "LoggingService"], ["UpdateStock"]);
// eCommercePlatform.addPearl("LoggingService", [], ["LogEvent"]);
// eCommercePlatform.addPearl("DatabaseService", [], ["ReadData", "WriteData"]);
// eCommercePlatform.addPearl("BankAPI", [], ["ChargeCard"]);
// eCommercePlatform.traceInterconnections("OrderProcessing", "PlaceOrder");
// eCommercePlatform.perceiveTheUnifyingSutra();

// The Gita states the Supreme (Brahman/Krishna) is the Sutra on which all universes (pearls) are strung.
// In a system, the core architectural principle or data flow acts as this Sutra.
</div>
                            <button class="practice-button" onclick="runConceptualCode('rajaVidyaCode')">Visualize Connections</button>
                            <div id="rajaVidyaCodeOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">System Mapping</h4>
                            <p>Choose a software project you are familiar with. Try to map out its main components and how they interact with each other. Identify any non-obvious or "secret" dependencies that make the system function as a whole.</p>
                            <textarea id="rajaVidyaReflectionInput" class="code-editor-input" placeholder="Describe the system map..."></textarea>
                            <button class="chapter-button" onclick="reflectOnSystem()">Reflect on System Map</button>
                            <div id="rajaVidyaReflectionOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                <div id="chapter10" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 10: The Yoga of Divine Glories (विभूतियोग)</h3>
                        <div class="verse-sanskrit">अहमात्मा गुडाकेश सर्वभूताशयस्थितः</div>
                        <div class="verse-translation">"I am the Self, O Gudakesha, situated in the hearts of all beings."</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">The Innate Potential of Code</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">Just as the divine Self resides in all beings, immense potential lies within code. Recognize the "glories" of well-crafted algorithms, elegant solutions, and the power of technology to transform the world. Nurture this potential in your work, seeing beyond mere functionality to the inherent beauty and impact.</p>
                            <div class="interactive-code" id="vibhutiCode">// Chapter 10: The Yoga of Divine Glories (Vibhuti Yoga)
// Recognizing the "divine excellences" or "glories" (Vibhutis) in various aspects of code and technology.
// Just as Krishna reveals His Vibhutis in the universe, we can see sparks of brilliance in well-crafted software.

class CodeVibhutiIdentifier {
    constructor() {
        console.log("[VibhutiYoga] Vibhuti Identifier initialized. Seeking excellences in code.");
    }

    // Identify Vibhutis (excellences) in a given piece of code or algorithm
    identifyExcellences(codeArtifact) {
        const { name, type, characteristics } = codeArtifact;
        const vibhutisFound = [];
        console.log(`\nAnalyzing '${name}' (${type}) for Vibhutis:`);

        // Among sorting algorithms, I am Quicksort (for its average-case efficiency and elegance)
        if (type === "Algorithm" && name.toLowerCase().includes("quicksort")) {
            if (characteristics.avgComplexity === "O(n log n)" && characteristics.inPlace) {
                vibhutisFound.push("Elegance in Divide and Conquer, Average-Case Efficiency");
            }
        }

        // Among data structures, I am the Hash Table (for its O(1) average access)
        if (type === "DataStructure" && name.toLowerCase().includes("hash table")) {
            if (characteristics.avgAccessTime === "O(1)") {
                vibhutisFound.push("Near Instantaneous Access/Search (Average Case)");
            }
        }
        
        // Among design patterns, I am the Observer Pattern (for its decoupling and event handling)
        if (type === "DesignPattern" && name.toLowerCase().includes("observer")) {
            if (characteristics.purpose === "decoupling publisher-subscriber") {
                vibhutisFound.push("Graceful Decoupling and Event Notification");
            }
        }

        // General Vibhutis in any code
        if (characteristics.readabilityScore > 0.9) vibhutisFound.push("Exceptional Clarity and Readability (like a clear sky)");
        if (characteristics.testCoverage >= 0.99) vibhutisFound.push("Robustness through Comprehensive Testing (like a strong mountain)");
        if (characteristics.scalability === "high") vibhutisFound.push("Immense Scalability (like the infinite ocean)");
        if (characteristics.securityLevel === "fortified") vibhutisFound.push("Impenetrable Security (like a divine shield)");
        if (characteristics.positiveImpact > 1000000) vibhutisFound.push("Transformative Positive Impact on many lives (like the life-giving Sun)");


        if (vibhutisFound.length > 0) {
            console.log(`  ✨ Divine Glories (Vibhutis) found in '${name}':`);
            vibhutisFound.forEach(vibhuti => console.log(`     - ${vibhuti}`));
        } else {
            console.log(`  No specific pre-defined Vibhutis identified in '${name}', but all well-intentioned code has potential for excellence.`);
        }
        return vibhutisFound;
    }
}

// To simulate in console:
// const vibhutiScanner = new CodeVibhutiIdentifier();
// const algorithm1 = { name: "SuperSort (Quicksort variant)", type: "Algorithm", characteristics: { avgComplexity: "O(n log n)", inPlace: true, readabilityScore: 0.7 } };
// const dataStructure1 = { name: "FastAccess Hash Table", type: "DataStructure", characteristics: { avgAccessTime: "O(1)", scalability: "medium" } };
// const designPattern1 = { name: "Notification Observer Pattern", type: "DesignPattern", characteristics: { purpose: "decoupling publisher-subscriber", readabilityScore: 0.95 } };
// const module1 = { name: "CommunityHealthModule", type: "SoftwareModule", characteristics: { readabilityScore: 0.92, testCoverage: 0.99, positiveImpact: 2000000, securityLevel: "fortified" } };
// vibhutiScanner.identifyExcellences(algorithm1);
// vibhutiScanner.identifyExcellences(dataStructure1);
// vibhutiScanner.identifyExcellences(designPattern1);
// vibhutiScanner.identifyExcellences(module1);

// Krishna says, "Know that all opulent, beautiful and glorious creations spring from but a spark of My splendor."
// Recognizing these "sparks" in code inspires us to strive for such excellence in our own work.
</div>
                            <button class="practice-button" onclick="runConceptualCode('vibhutiCode')">Recognize Glories</button>
                            <div id="vibhutiCodeOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">Appreciating Code</h4>
                            <p>Think about a piece of code (your own or someone else's) that you find particularly impressive or inspiring. What "divine glories" (qualities like elegance, efficiency, robustness, positive impact) does it possess? Reflect on what makes it stand out.</p>
                            <textarea id="vibhutiReflectionInput" class="code-editor-input" placeholder="Describe the glories of the code..."></textarea>
                            <button class="chapter-button" onclick="reflectOnGlories()">Reflect on Code Glories</button>
                            <div id="vibhutiReflectionOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                <div id="chapter11" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 11: The Yoga of the Vision of the Universal Form (विश्वरूपदर्शनयोग)</h3>
                        <div class="verse-sanskrit">पश्य मे पार्थ रूपाणि शतशोऽथ सहस्रशः</div>
                        <div class="verse-translation">"Behold, O Partha, My hundreds and thousands of multifarious, divine forms."</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">The Vastness of Technology</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">The world of technology is immense, ever-expanding, and multifaceted. From embedded systems to quantum computing, from AI to biotechnology, the "universal form" of code is awe-inspiring. Recognize the vastness and diversity of this field and your place within it, with both humility for what you don't know and wonder for what's possible.</p>
                            <div class="interactive-code" id="vishvarupaCode">// Chapter 11: The Yoga of the Vision of the Universal Form (Vishvarupa Darshana Yoga)
// Perceiving the vast, interconnected, and sometimes overwhelming "Universal Form" of Technology.

class TechUniverseExplorer {
    constructor() {
        this.knownDomains = [ // Just a tiny fraction of the "Universal Form"
            { name: "Web Development (Frontend/Backend)", complexity: 8, interconnectedness: 9 },
            { name: "Mobile App Development (iOS/Android)", complexity: 8, interconnectedness: 8 },
            { name: "Data Science & Machine Learning", complexity: 9, interconnectedness: 7 },
            { name: "Artificial Intelligence (Deep Learning, NLP)", complexity: 10, interconnectedness: 8 },
            { name: "Cloud Computing (AWS, Azure, GCP)", complexity: 9, interconnectedness: 10 },
            { name: "Cybersecurity", complexity: 9, interconnectedness: 9 },
            { name: "Blockchain & DLT", complexity: 8, interconnectedness: 6 },
            { name: "IoT (Internet of Things)", complexity: 7, interconnectedness: 9 },
            { name: "Game Development", complexity: 9, interconnectedness: 7 },
            { name: "Quantum Computing", complexity: 10, interconnectedness: 5, nascent: true },
            { name: "Embedded Systems", complexity: 7, interconnectedness: 6 },
            { name: "Bioinformatics & Computational Biology", complexity: 9, interconnectedness: 7 }
        ];
        console.log("[Vishvarupa] Tech Universe Explorer ready. The forms are many!");
    }

    // Arjuna asks to see the Universal Form. We attempt to glimpse it.
    glimpseUniversalForm(depthLevel = 1) {
        console.log(`\nAttempting to glimpse the Universal Form of Technology (Depth: ${depthLevel}):`);
        if (depthLevel >= 1) {
            console.log("  Beholding major domains (like cosmic limbs):");
            this.knownDomains.forEach(domain => {
                console.log(`    - Domain: ${domain.name} (Complexity: ${domain.complexity}/10)`);
            });
            console.log("  ...and countless other specialized fields, languages, frameworks, tools...");
        }
        
        if (depthLevel >= 2) {
            console.log("\n  Peering deeper into the interconnectedness (like galaxies within galaxies):");
            const webDev = this.knownDomains.find(d => d.name.includes("Web Development"));
            if (webDev) {
                console.log(`    Within ${webDev.name}:`);
                console.log("      - HTML, CSS, JavaScript (foundations, like atoms)");
                console.log("      - React, Angular, Vue (frameworks, like star systems)");
                console.log("      - Node.js, Python/Django, Ruby/Rails (backend engines, like black holes powering galaxies)");
                console.log("      - Databases (SQL, NoSQL) (repositories of cosmic data)");
                console.log("      - APIs, Microservices (interstellar communication networks)");
            }
        }

        if (depthLevel >= 3) {
             console.log("\n  Contemplating the underlying principles (like the laws of physics governing the cosmos):");
             console.log("    - Logic, Algorithms, Data Structures (the mathematics of this universe)");
             console.log("    - Computation Theory (the metaphysics)");
             console.log("    - Network Protocols (the forces of interaction)");
             console.log("    - Operating Systems (the fabric of spacetime for software)");
        }
        
        console.log("\n[Vishvarupa] The vision is awe-inspiring, vast, and ever-expanding.");
        console.log("  Humility arises from realizing how little one individual can know of this entirety.");
        console.log("  Wonder arises from the infinite potential and creativity manifest.");
        // Like Arjuna, the coder might feel overwhelmed but also deeply reverent.
    }

    findYourPlace(mySkills, myInterests) {
        console.log("\n[Vishvarupa] Finding one's role within this vast Universal Form:");
        console.log(`  My Skills: [${mySkills.join(', ')}]`);
        console.log(`  My Interests: [${myInterests.join(', ')}]`);
        // Conceptual: match skills/interests to relevant domains
        console.log("  Even a small contribution to one part connects to the whole.");
        console.log("  Focus on your Dharma (duty/path) within this vastness, and contribute with skill.");
    }
}

// To simulate in console:
// const explorer = new TechUniverseExplorer();
// explorer.glimpseUniversalForm(1); // Glimpse major domains
// explorer.glimpseUniversalForm(2); // Glimpse deeper into one domain
// explorer.glimpseUniversalForm(3); // Contemplate underlying principles
// explorer.findYourPlace(["JavaScript", "React", "Node.js"], ["Web Applications", "AI Interfaces"]);

// The vision of Vishvarupa showed Arjuna the interconnectedness and vastness of the Divine.
// Exploring technology with this mindset can foster humility, wonder, and a desire to learn.
</div>
                            <button class="practice-button" onclick="runConceptualCode('vishvarupaCode')">Contemplate Vastness</button>
                            <div id="vishvarupaCodeOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">Exploring New Horizons</h4>
                            <p>Identify a domain of technology that you know little about but find fascinating. Make a small effort this week to learn something new about it (e.g., watch an introductory video, read an article), appreciating the vastness of the field.</p>
                            <textarea id="vishvarupaReflectionInput" class="code-editor-input" placeholder="My exploration goal..."></textarea>
                            <button class="chapter-button" onclick="setExplorationGoal()">Set Exploration Goal</button>
                            <div id="vishvarupaReflectionOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                <div id="chapter12" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 12: The Yoga of Devotion (भक्तियोग)</h3>
                        <div class="verse-sanskrit">मय्येव मन आधत्स्व मयि बुद्धिं निवेशय</div>
                        <div class="verse-translation">"Just fix your mind upon Me, the Supreme Personality of Godhead, and engage all your intelligence in Me."</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">Coding with Devotion</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">Approach your work with devotion, fixing your mind and intelligence entirely on the task at hand. See your projects as a form of offering, and perform your duties with utmost love, care, and dedication. This devotion transforms mundane coding into a fulfilling spiritual practice.</p>
                            <div class="interactive-code" id="bhaktiCode">// Chapter 12: The Yoga of Devotion (Bhakti Yoga)
// Cultivating devotion (Bhakti) in the act of coding.
// Fixing the mind and intellect on the task as an offering to the "Supreme"
// (which can be an ideal, a principle, the users, or a higher purpose).

class DevotionalCoder {
    constructor(name, devotionTarget) {
        this.name = name;
        // The "Ishta-Devata" or chosen ideal for the coder's devotion:
        // e.g., "Users' Well-being", "Craftsmanship", "Open Source Spirit", "Solving This Problem Perfectly"
        this.devotionTarget = devotionTarget; 
        this.mind = "distracted";
        this.intellect = "unfocused";
        this.currentTask = null;
        console.log(`[BhaktiYoga] Devotional Coder '${name}' initialized. Target of Devotion: '${this.devotionTarget}'.`);
    }

    // Mayyeva Mana Adhatsva: Fixing the mind on the Divine (Devotion Target)
    focusMindOnDevotionTarget(task) {
        this.currentTask = task;
        console.log(`\nPreparing for task: '${task.description}' with devotion to '${this.devotionTarget}'.`);
        console.log("  Clearing mental clutter. Recalling the purpose and ideal.");
        this.mind = `fixed_on_${this.devotionTarget}_through_${task.id}`;
        console.log(`  Mind status: ${this.mind}.`);
    }

    // Mayi Buddhim Niveshaya: Engaging the intellect in the Divine
    engageIntellectWithLoveAndCare() {
        if (this.mind.startsWith("fixed_on_")) {
            console.log("  Engaging intellect with utmost care, love, and precision for this offering.");
            this.intellect = `fully_engaged_in_${this.currentTask.id}_for_${this.devotionTarget}`;
            // Conceptual: This implies meticulous attention to detail, thoughtful design, empathy for users.
            console.log(`  Intellect status: ${this.intellect}.`);
            return true;
        } else {
            console.log("  Mind not yet fixed. Intellect cannot be fully engaged devotionally.");
            return false;
        }
    }

    // Performing the Kर्मा (Karma/Action) as Bhakti (Devotion)
    codeWithDevotion(task) {
        this.focusMindOnDevotionTarget(task);
        if (this.engageIntellectWithLoveAndCare()) {
            console.log(`\n[BhaktiYoga] Commencing coding for '${task.description}' as a devotional offering.`);
            // Simulating the coding process, infused with Bhakti
            let solution = `// Code for ${task.description}\n`;
            solution += `// Crafted with mindfulness, precision, and dedication to ${this.devotionTarget}.\n`;
            solution += `// Every line, every function, every comment is part of the offering.\n`;
            // ... actual meticulous coding would happen here ...
            task.code = solution + `System.out.println("Task ${task.id} completed with devotion.");`;
            console.log(`  Task '${task.description}' completed. Code is an expression of devotion.`);
            this.currentTask = null;
            this.mind = "peaceful_after_offering";
            this.intellect = "at_rest";
        } else {
            console.log(`[BhaktiYoga] Could not commence coding with full devotion. Mind or intellect not ready.`);
        }
    }
}

// To simulate in console:
// const bhaktiDeveloper = new DevotionalCoder("Priya", "The Art of Elegant Solutions");
// const criticalBugFixTask = { id: "BUG-777", description: "Fix critical data corruption bug affecting all users", code: null };
// bhaktiDeveloper.codeWithDevotion(criticalBugFixTask);
// const newFeatureTask = { id: "FEAT-101", description: "Develop a new accessibility feature", code: null };
// bhaktiDeveloper.codeWithDevotion(newFeatureTask); 

// Bhakti Yoga in coding transforms work from a chore into a joyful, purposeful offering.
// The quality of work often improves as it's done with love and full attention.
</div>
                            <button class="practice-button" onclick="runConceptualCode('bhaktiCode')">Simulate Devotional Coding</button>
                            <div id="bhaktiCodeOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">Devotion in Action</h4>
                            <p>Choose a coding task today and approach it with a sense of devotion. Eliminate distractions, focus your mind, and dedicate your full attention to the process. Observe if your experience of coding changes when imbued with this attitude.</p>
                            <textarea id="bhaktiReflectionInput" class="code-editor-input" placeholder="Reflect on your devotional coding..."></textarea>
                            <button class="chapter-button" onclick="startBhaktiPractice()">Begin Bhakti Practice</button>
                            <div id="bhaktiReflectionOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                <div id="chapter13" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 13: The Yoga of the Distinction Between the Field and the Knower of the Field (क्षेत्रक्षेत्रज्ञविभागयोग)</h3>
                        <div class="verse-sanskrit">इदं शरीरं कौन्तेय क्षेत्रमित्यभिधीयते</div>
                        <div class="verse-translation">"This body, O son of Kunti, is called the field, and one who knows this body is called the knower of the field."</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">Code as the Field, Programmer as the Knower</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">See your codebase, your project, or even the entire technological landscape as the "field" (Kshetra) – a complex, dynamic entity with its own properties and behaviors. You, the programmer, are the "knower of the field" (Kshetrajna) – the conscious observer, interpreter, and manipulator of this field. Understanding this distinction brings objectivity and clarity to your work, allowing you to debug not just code, but also your own biases and assumptions.</p>
                            <div class="interactive-code" id="kshetraCode">// Chapter 13: The Field (Kshetra) and the Knower of the Field (Kshetrajna)
// Distinguishing between the codebase/system (The Field) and the programmer/observer (The Knower).

// The Kshetra (The Field): A software module with its properties and state
class SoftwareModule_Kshetra {
    constructor(name, code, dependencies, bugs = []) {
        this.name = name; // Name of the field
        this.code = code; // The actual content of the field
        this.dependencies = dependencies; // Interactions with other fields
        this.currentState = "idle";
        this.knownBugs = bugs; // Imperfections within the field
        this.executionLog = [];
        console.log(`[Kshetra] Field '${name}' defined. Initial state: ${this.currentState}.`);
    }

    executeFunction(functionName, params) {
        this.currentState = `executing_${functionName}`;
        this.executionLog.push(`Executing ${functionName} with ${JSON.stringify(params)}.`);
        // Conceptual: Simulating execution and potential for bugs
        if (functionName === "processPayment" && params.amount < 0) {
            this.knownBugs.push({ id: "B003", desc: "Negative payment processed!", severity: "critical" });
            this.currentState = "error_state";
            this.executionLog.push("CRITICAL ERROR: Negative payment processed!");
            return { success: false, error: "Invalid payment amount." };
        }
        this.executionLog.push(`${functionName} executed successfully.`);
        this.currentState = "idle_after_" + functionName;
        return { success: true, result: "some_value" };
    }

    displayState() {
        console.log(`  [Kshetra Display] Module '${this.name}': Current State: ${this.currentState}, Bugs: ${this.knownBugs.length}`);
    }
}

// The Kshetrajna (The Knower of the Field): The Programmer / Observer
class Programmer_Kshetrajna {
    constructor(name, experienceLevel) {
        this.name = name; // The identity of the Knower
        this.experienceLevel = experienceLevel;
        this.observations = [];
        this.isAttachedToField = false; // Key for objectivity: not identifying with the field
        console.log(`[Kshetrajna] Knower '${name}' (Experience: ${experienceLevel}) is now observing.`);
    }

    // The Knower observes the Field without becoming it.
    observeField(kshetra_module) {
        console.log(`\n[Kshetrajna] ${this.name} is observing the Field: '${kshetra_module.name}'.`);
        kshetra_module.displayState();
        this.observations.push(`Observed '${kshetra_module.name}' in state '${kshetra_module.currentState}'.`);
        
        if (kshetra_module.knownBugs.length > 0) {
            console.log(`  [Kshetrajna] Noticed ${kshetra_module.knownBugs.length} bugs.`);
            if (this.isAttachedToField && kshetra_module.code.includes(`// Authored by ${this.name}`)) {
                console.log(`    [Attachment] "Oh no, *my* code has bugs! I am a failure!" (Lost objectivity)`);
            } else {
                console.log(`    [Objectivity] "Bugs exist in the field. Let's analyze and rectify." (Maintained distinction)`);
            }
        }
    }

    // The Knower interacts with (manipulates) the Field
    debugField(kshetra_module, bugId) {
        console.log(`\n[Kshetrajna] ${this.name} attempting to debug bug '${bugId}' in Field '${kshetra_module.name}'.`);
        const bugIndex = kshetra_module.knownBugs.findIndex(b => b.id === bugId);
        if (bugIndex !== -1) {
            console.log(`  [Kshetrajna] Rectifying bug: ${kshetra_module.knownBugs[bugIndex].desc}`);
            kshetra_module.knownBugs.splice(bugIndex, 1);
            kshetra_module.code += `\n// Fix for ${bugId} applied by ${this.name}`;
            console.log(`  [Kshetrajna] Bug '${bugId}' resolved in Field '${kshetra_module.name}'.`);
        } else {
            console.log(`  [Kshetrajna] Bug '${bugId}' not found.`);
        }
    }
}

// To simulate in console:
// const paymentModule_Field = new SoftwareModule_Kshetra("PaymentProcessor", "function processPayment(params) { /* ... */ } // Authored by DevA", ["OrderService"], [{ id: "B001", desc: "Timeout issue", severity: "high" }]);
// const seniorDev_Knower = new Programmer_Kshetrajna("DevA_TheKnower", "Senior");
// seniorDev_Knower.isAttachedToField = true; 
// seniorDev_Knower.observeField(paymentModule_Field);
// paymentModule_Field.executeFunction("processPayment", { amount: -100 }); 
// seniorDev_Knower.observeField(paymentModule_Field); 
// seniorDev_Knower.isAttachedToField = false; 
// seniorDev_Knower.observeField(paymentModule_Field);
// seniorDev_Knower.debugField(paymentModule_Field, "B003");
// seniorDev_Knower.observeField(paymentModule_Field);

// Understanding Kshetra-Kshetrajna distinction brings objectivity, reduces stress, and improves problem-solving.
</div>
                            <button class="practice-button" onclick="runConceptualCode('kshetraCode')">Observe the Code Field</button>
                            <div id="kshetraCodeOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">Field and Knower Reflection</h4>
                            <p>For your current project, identify what constitutes the "field" (e.g., codebase, deployment environment). Then, recognize yourself as the "knower." How does distinguishing between the two help you understand and interact with your work more effectively?</p>
                            <textarea id="kshetraReflectionInput" class="code-editor-input" placeholder="Reflect on the code as a field..."></textarea>
                            <button class="chapter-button" onclick="reflectOnKshetra()">Reflect on Field & Knower</button>
                            <div id="kshetraReflectionOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                <div id="chapter14" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 14: The Yoga of the Division of the Three Gunas (गुणत्रयविभागयोग)</h3>
                        <div class="verse-sanskrit">सत्त्वं रजस्तम इति गुणाः प्रकृतिसंभवाः</div>
                        <div class="verse-translation">"Goodness, passion, and ignorance—these qualities born of material nature bind the embodied living entity in the body."</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">Understanding the Gunas in Development</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">The three Gunas (Sattva, Rajas, Tamas) influence our programming style and output. <em>Sattva</em> (goodness, purity) manifests as clear, clean, well-documented, and thoroughly tested code; a calm, focused, and cooperative developer. <em>Rajas</em> (passion, activity) can lead to rapid but sometimes messy development, driven by ambition, deadlines, or a desire for quick results, often with associated stress. <em>Tamas</em> (ignorance, inertia) results in procrastination, buggy or poorly understood code, resistance to learning new things, and a general lack of clarity or engagement. Strive for Sattvic coding, recognizing and transcending the influences of Rajas and Tamas.</p>
                            <div class="interactive-code" id="gunasCode">// Chapter 14: The Three Gunas (Qualities of Material Nature) in Coding
// Sattva (Goodness, Clarity), Rajas (Passion, Activity), Tamas (Ignorance, Inertia)

function describeCodingApproach(guna) {
    let profile = {};
    switch(guna) {
        case "Sattva": 
            profile = {
                mindset: "Calm, focused, seeks knowledge, disciplined, aims for quality & understanding.",
                process: "Systematic planning, writes clean & well-documented code, thorough testing, values maintainability.",
                output: "Elegant, robust, readable, efficient, low bug density.",
                motivation: "Joy of creation, service, pursuit of excellence, ethical considerations.",
                codeExample: "function sattvic_calculate(data) { /* clear, robust, tested logic */ return processedData; }"
            };
            break;
        case "Rajas": 
             profile = {
                mindset: "Driven, ambitious, restless, seeks quick results, can be stressed or competitive.",
                process: "Rapid development, focuses on features over deep quality, may cut corners for speed, docs/tests might be rushed.",
                output: "Functional (often), can be complex/messy, potential for hidden bugs, focuses on 'getting it done'.",
                motivation: "Achievement, recognition, deadlines, excitement of new tech (can be superficial).",
                codeExample: "function rajasic_fastFeature(input) { /* works for demo, many shortcuts, complex */ globalState.update(input); }"
            };
            break;
        case "Tamas": 
            profile = {
                mindset: "Lethargic, procrastinates, resistant to learning, confused, careless, may blame externals.",
                process: "Avoids tasks, copy-pastes without understanding, no planning, no testing, resists best practices.",
                output: "Buggy, inconsistent, unmaintainable, often breaks, security flaws, poorly understood.",
                motivation: "Inertia, avoidance of effort, delusion, following outdated/wrong advice blindly.",
                codeExample: "function tamasic_mysteryCode(value) { if(value == 'magic') oldApi.doSomethingUnpredictable(); /* what does this do? */ }"
            };
            break;
        default: 
            console.log("Unknown Guna"); return;
    }
    console.log(`\n--- [${guna.toUpperCase()}] Coding Approach ---`);
    Object.entries(profile).forEach(([key, value]) => console.log(`  ${key.charAt(0).toUpperCase() + key.slice(1)}: ${value}`));
}

// To simulate in console:
// describeCodingApproach("Sattva");
// describeCodingApproach("Rajas");
// describeCodingApproach("Tamas");

// The Gita advises transcending the Gunas, but practically, one cultivates Sattva
// to overcome the detrimental effects of Rajas and Tamas, leading to clarity and skillful action.
</div>
                            <button class="practice-button" onclick="runConceptualCode('gunasCode')">Analyze Gunas in Code</button>
                            <div id="gunasCodeOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">Guna Self-Assessment</h4>
                            <p>Reflect on your typical coding habits and recent projects. When do you find yourself operating predominantly in Sattva, Rajas, or Tamas? How can you consciously cultivate more Sattvic qualities (e.g., focus, clarity, clean code) in your work and your approach?</p>
                            <textarea id="gunasReflectionInput" class="code-editor-input" placeholder="My Guna self-assessment..."></textarea>
                            <button class="chapter-button" onclick="reflectOnGunas()">Reflect on Gunas</button>
                            <div id="gunasReflectionOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                <div id="chapter15" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 15: The Yoga of the Supreme Person (पुरुषोत्तमयोग)</h3>
                        <div class="verse-sanskrit">ऊर्ध्वमूलमधःशाखमश्वत्थं प्राहुरव्ययम्</div>
                        <div class="verse-translation">"They speak of an imperishable Ashvattha tree with its roots upward and its branches downward, whose leaves are the Vedic hymns."</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">The Tree of Technology</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">Visualize technology as a vast, inverted tree: its roots (fundamental principles like logic, algorithms, mathematics, data structures, computation theory) are unseen but support everything; its branches (frameworks, libraries, specific languages) spread widely and are constantly evolving. The "leaves" are the ever-changing trends and fleeting specifics. True mastery lies in understanding the roots, not just clinging to the leaves (superficial trends or specific syntaxes). Detach from the illusion of the tree's permanence and seek its source.</p>
                            <div class="interactive-code" id="purushottamaCode">// Chapter 15: Purushottama Yoga - The Ashvattha Tree of Technology

const TechAshvattha = {
    Roots_FundamentalPrinciples: [
        "Logic & Computation Theory (Ultimate source)",
        "Mathematics (Underpinning algorithms)",
        "Core Data Structures & Algorithms (Timeless patterns)",
        "OS & Networking Principles (Fabric of interaction)"
    ],
    Trunk_CoreLanguages: ["C/C++", "Java", "Python", "JavaScript"],
    Branches_ParadigmsAndStacks: {
        "Web Dev": { frameworks: ["React", "Vue"], protocols: ["HTTP"] },
        "AI/ML": { libraries: ["TensorFlow", "PyTorch"], concepts: ["Neural Nets"] }
    },
    Leaves_TransientDetails: ["FrameworkXYZ v3.1.4-beta", "Latest JS library", "Specific API syntax"],

    explore(coderFocus) {
        console.log("🌳 Exploring the Ashvattha Tree of Technology:");
        console.log("  🌿 ROOTS (Unseen Source - Seek these for mastery):");
        this.Roots_FundamentalPrinciples.forEach(r => console.log(`    - ${r}`));
        console.log("  🌲 TRUNK (Core Languages - Conduits):");
        this.Trunk_CoreLanguages.forEach(t => console.log(`    - ${t}`));
        console.log("  🌴 BRANCHES (Manifest Stacks - Navigate skillfully):");
        Object.entries(this.Branches_ParadigmsAndStacks).forEach(([b, d]) => console.log(`    - ${b}: (Frameworks: ${d.frameworks ? d.frameworks.join(', ') : (d.libraries ? d.libraries.join(', ') : '')})`));
        console.log("  🍃 LEAVES (Transient Details - Useful, but don't get lost):");
        this.Leaves_TransientDetails.forEach(l => console.log(`    - ${l}`));

        if (coderFocus === "Roots") console.log("\n  WISDOM: Focusing on Roots brings deep understanding & adaptability.");
        else if (coderFocus === "Leaves") console.log("\n  CAUTION: Focusing only on Leaves leads to chasing trends. Seek Roots!");
    }
};

// To simulate in console:
// TechAshvattha.explore("Roots");
// TechAshvattha.explore("Leaves");

// Gita: Cut attachment to this worldly tree with detachment axe, seek Supreme Source.
// Coders: Master fundamentals (Roots) to navigate ever-changing tech (Branches/Leaves).
</div>
                            <button class="practice-button" onclick="runConceptualCode('purushottamaCode')">Explore Tech Tree</button>
                            <div id="purushottamaCodeOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">Root-Level Learning</h4>
                            <p>Instead of chasing the latest "leaf" (new framework/tool), commit to strengthening your understanding of a fundamental "root" (e.g., how compilers work, network protocols, object-oriented design patterns, functional programming principles). How will this deepen your overall knowledge and adaptability?</p>
                            <textarea id="purushottamaReflectionInput" class="code-editor-input" placeholder="My root-level learning goal..."></textarea>
                            <button class="chapter-button" onclick="setPurushottamaGoal()">Set Learning Goal</button>
                            <div id="purushottamaReflectionOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                <div id="chapter16" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 16: The Divine and Demoniac Natures (दैवासुरसंपद्विभागयोग)</h3>
                        <div class="verse-sanskrit">अभयं सत्त्वसंशुद्धिर्ज्ञानयोगव्यवस्थितिः</div>
                        <div class="verse-translation">"Fearlessness, purification of one's existence, cultivation of spiritual knowledge, charity, self-control, performance of sacrifice, study of the Vedas, austerity, simplicity..." (qualities of divine nature)</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">Divine vs. Demoniac Coding Qualities</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">Recognize and cultivate "divine" qualities in your coding practice: fearlessness in tackling complex problems and admitting mistakes, purity in code (cleanliness, correctness, lack of hidden bugs), a relentless quest for knowledge, generosity in sharing insights (mentoring, open source), self-control over bad habits (procrastination, cutting corners, over-engineering). Avoid "demoniac" traits like arrogance, anger (at code or colleagues), ignorance, and dishonesty in your development practices.</p>
                            <div class="interactive-code" id="divineNatureCode">// Chapter 16: Daivasura Sampad Vibhaga Yoga - Divine & Demoniac Coding Natures

function exhibitQualitiesInCodeReview(reviewerNature, authorNature, codeHasIssues) {
    console.log(`\n--- Code Review Simulation ---`);
    console.log(`Reviewer: ${reviewerNature}, Author: ${authorNature}, Code Issues: ${codeHasIssues}`);

    if (reviewerNature === "Divine") {
        console.log("  Reviewer (Divine): Constructive, patient, seeks understanding.");
        if (codeHasIssues) console.log("    Feedback: 'Noticed potential issue. Let's discuss for clarity/robustness.'");
        else console.log("    Feedback: 'Looks great! Consider this edge case for future proofing?'");
    } else { 
        console.log("  Reviewer (Demoniac): Arrogant, harsh, fault-finding.");
        if (codeHasIssues) console.log("    Feedback: 'This is terrible! How could you write this?!'");
        else console.log("    Feedback: 'Hmph. No obvious bugs, but my way is better.'");
    }

    if (authorNature === "Divine") {
        console.log("  Author (Divine): Humble, open to learning, self-controlled.");
        console.log("    Response: 'Thank you for the feedback! I'll address this and learn.'");
    } else { 
        console.log("  Author (Demoniac): Defensive, angry, dishonest.");
        if (codeHasIssues) console.log("    Response: 'You don't understand my genius! It's not a bug!'");
        else console.log("    Response: 'Whatever. My code is fine.'");
    }
}

// To simulate in console:
// exhibitQualitiesInCodeReview("Divine", "Divine", true);
// exhibitQualitiesInCodeReview("Demoniac", "Divine", true);

// Cultivating Divine (Daivi) qualities (fearlessness, purity, honesty, self-control)
// leads to better code, teamwork, and peace. Avoid Demoniac (Asuri) traits.
</div>
                            <button class="practice-button" onclick="runConceptualCode('divineNatureCode')">Cultivate Divine Code</button>
                            <div id="divineNatureCodeOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">Cultivating Qualities</h4>
                            <p>Identify one "divine" quality you want to cultivate more in your programming (e.g., patience, attention to detail, courage to admit mistakes, humility). Then, identify one "demoniac" tendency you want to reduce (e.g., imposter syndrome, perfectionism that paralyzes, overconfidence, blaming others). Plan a small, actionable step for each this week.</p>
                            <textarea id="divineNatureReflectionInput" class="code-editor-input" placeholder="My quality cultivation plan..."></textarea>
                            <button class="chapter-button" onclick="planQualityCultivation()">Plan Cultivation</button>
                            <div id="divineNatureReflectionOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                <div id="chapter17" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 17: The Divisions of Faith (श्रद्धात्रयविभागयोग)</h3>
                        <div class="verse-sanskrit">त्रिविधा भवति श्रद्धा देहिनां सा स्वभावजा</div>
                        <div class="verse-translation">"According to the mode of nature one has acquired, a living entity develops a particular kind of faith."</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">Faith in Programming Paradigms</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">Our "faith" in programming paradigms (e.g., OOP, Functional, Agile, Waterfall, specific languages/frameworks) is deeply influenced by our Gunas. <em>Sattvic faith</em> is in principles that lead to robust, maintainable, secure, and ethical software; it is based on sound reasoning and empirical evidence. <em>Rajasic faith</em> is in quick fixes, trendy tools, or solutions that bring personal glory or rapid but superficial results. <em>Tamasic faith</em> is in outdated methods, superstition about technology, resistance to best practices, or a fundamental lack of belief in one's ability to learn and improve. Cultivate Sattvic faith in sound engineering principles and continuous improvement.</p>
                            <div class="interactive-code" id="faithCode">// Chapter 17: Shraddha Traya Vibhaga Yoga - Three Divisions of Faith in Coding

function describeProgrammerFaithByGuna(dominantGuna) {
    console.log(`\n--- Programmer's Faith (Shraddha) influenced by ${dominantGuna} Guna ---`);
    let faithIn, approach, example;

    switch(dominantGuna) {
        case "Sattvic":
            faithIn = "Proven Engineering Principles, Ethical Guidelines, User Well-being, Empirical Evidence.";
            approach = "Diligent study, meticulous implementation, thorough testing, collaborative improvement.";
            example = "Trusts TDD for robust code, based on experience and reason.";
            break;
        case "Rajasic":
            faithIn = "Latest Trendy Frameworks, Quick MVP Success, Personal Glory, Competitive Edge.";
            approach = "Rapid adoption of new tech (superficially), focus on visible results, aggressive pursuit of deadlines.";
            example = "Adopts 'Microservices-for-everything' because it's trendy, even if a monolith is better suited.";
            break;
        case "Tamasic":
            faithIn = "Outdated Methods (regardless of efficacy), Superstition ('it worked once'), Avoiding Effort.";
            approach = "Blindly following old habits, copy-pasting without understanding, resisting new learning, neglecting quality.";
            example = "Insists on using a deprecated library with known security flaws due to inertia.";
            break;
        default: console.log("Unknown faith type."); return;
    }
    console.log(`  Faith In: ${faithIn}`);
    console.log(`  Approach Reflecting Faith: ${approach}`);
    console.log(`  Example: ${example}`);
}

// To simulate in console:
// describeProgrammerFaithByGuna("Sattvic");
// describeProgrammerFaithByGuna("Rajasic");
// describeProgrammerFaithByGuna("Tamasic");

// Cultivating Sattvic faith—based on knowledge, reason, and desire for lasting good—is key.
</div>
                            <button class="practice-button" onclick="runConceptualCode('faithCode')">Assess Your Faith</button>
                            <div id="faithCodeOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">Examining Your Faith</h4>
                            <p>What programming methodologies or technologies do you have strong "faith" in? Where does this faith come from (e.g., personal success, community influence, deep understanding)? Is it based on sound principles, or simply convenience or trend? How can you ensure your faith is Sattvic and promotes true progress?</p>
                            <textarea id="faithReflectionInput" class="code-editor-input" placeholder="Reflect on your programming faith..."></textarea>
                            <button class="chapter-button" onclick="examineProgrammingFaith()">Examine My Faith</button>
                            <div id="faithReflectionOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
                <div id="chapter18" class="content-section">
                    <div class="chapter-content">
                        <h3 style="color: #ffd700; margin-bottom: 1.5rem;">Chapter 18: The Yoga of Liberation (मोक्षसंन्यासयोग)</h3>
                        <div class="verse-sanskrit">सर्वधर्मान्परित्यज्य मामेकं शरणं व्रज</div>
                        <div class="verse-translation">"Abandon all varieties of dharma and simply surrender unto Me."</div>
                        <div class="programming-application">
                            <h4 style="color: #4ecdc4;">The Ultimate Surrender in Code</h4>
                            <p style="color: #d1d1e0; line-height: 1.8;">True liberation in programming comes from surrendering the ego of being "the brilliant coder." When you let go of attachment to outcomes, personal glory, rigid methods, or even specific solutions, you become a pure instrument of the code itself. The best code often seems to write itself through a clear channel, with the programmer merely facilitating its manifestation. This is the ultimate "pull request" to universal consciousness – letting the divine flow through your fingers.</p>
                            <div class="interactive-code" id="surrenderCode">// Chapter 18: Moksha Sannyasa Yoga - Liberation through Renunciation & Surrender

// State 1: The Ego-Driven Coder (Attached to "Dharmas" of self-identity, methods, outcomes)
class EgoBoundCoder {
    constructor(name, preferredTool) {
        this.identity = `The Great ${name}, Master of ${preferredTool}`;
        this.myDharmas = [`Always use ${preferredTool}`, "My code must be perfect & praised", "Avoid failure"];
        console.log(`[EgoBound] ${this.identity} active. Bound by dharmas: ${this.myDharmas.join('; ')}`);
    }
    solveProblem(problemDesc) {
        console.log(`  [EgoBound] Solving '${problemDesc}' with MY methods for MY glory.`);
        console.log("    Process fraught with anxiety about outcome and personal validation.");
        return "Solution reflects ego's limitations and attachments.";
    }
}

// State 2: The Liberated Coder (Sarva Dharman Parityajya, Mam Ekam Sharanam Vraja)
class SurrenderedCoder {
    constructor(name) {
        this.trueSelf = `An Instrument of Pure Logic & Creativity (${name})`;
        console.log(`[Surrendered] ${this.trueSelf} active. All limited dharmas renounced.`);
    }
    channelSolution(problemDesc) {
        console.log(`\n  [Surrendered] Approaching '${problemDesc}' with complete surrender to optimal flow.`);
        console.log("    Letting go of preconceived notions, preferred tools, desire for specific outcomes.");
        console.log("    Becoming a clear conduit for the solution to manifest...");
        let manifestedSolution = `
        // Problem: ${problemDesc}
        // Solution via Surrendered Flow:
        function findOptimalSolution_for_${problemDesc.replace(/\s/g, '_')}() {
            // ... The code is simple, direct, and perfectly solves the problem ...
            return "The most fitting solution, manifested with ease and clarity.";
        }`;
        console.log("    Manifested Solution:\n" + manifestedSolution);
        console.log("    Action performed with utmost skill, yet without burden of ego. Peace prevails.");
        return "Solution manifested through pure, unattached instrumentality.";
    }
}

// To simulate in console:
// const coderWithEgo = new EgoBoundCoder("MaxPower", "FrameworkX");
// coderWithEgo.solveProblem("Highly complex data synchronization");
// const coderInSurrender = new SurrenderedCoder("ShantiDev"); // Shanti = Peace
// coderInSurrender.channelSolution("Highly complex data synchronization");

// Gita's ultimate message: True freedom (Moksha) and perfect action from surrendering
// the limited self and its attachments, acting as a pure instrument of the Divine.
</div>
                            <button class="practice-button" onclick="runConceptualCode('surrenderCode')">Simulate Surrender</button>
                            <div id="surrenderCodeOutput" class="interactive-code-output"></div>
                        </div>
                        <div class="practice-exercise">
                            <h4 style="color: #ff6b6b;">The Final Practice: Surrender</h4>
                            <p>For your next coding session, practice complete surrender. Let go of all expectations, self-judgment, and attachment to the outcome. Simply observe the code flowing through you, allowing the solution to manifest. What does this feel like?</p>
                            <textarea id="surrenderReflectionInput" class="code-editor-input" placeholder="Reflect on your surrender experience..."></textarea>
                            <button class="chapter-button" onclick="practiceCompleteSurrender()">Practice Surrender</button>
                            <div id="surrenderReflectionOutput" class="interactive-code-output"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="code-challenges" class="tab-content">
                <div class="challenge-card">
                    <h4>Challenge 1: Karma Yoga Refactoring</h4>
                    <p>Take an old, messy function in your codebase (or a sample). Refactor it for clarity and efficiency, but without concern for whether anyone will immediately notice or praise your work. Focus purely on the action of improving the code.</p>
                    <pre><code>// Before (example):
function processData(d) { /* ... complex logic ... */ }

// After (Karma Yoga refactoring):
function processDataCleanly(dataItems) { /* ... clean code ... */ }
                    </code></pre>
                    <button class="run-challenge-button" onclick="startChallenge('challenge1Output', 'Challenge 1 accepted! Focus on the action of refactoring, not the immediate outcome. True skill is in the work itself.')">Begin Challenge</button>
                    <div id="challenge1Output" class="challenge-output"></div>
                </div>

                <div class="challenge-card">
                    <h4>Challenge 2: Dhyana Debugging</h4>
                    <p>When encountering a tricky bug, instead of panicking, approach it with a meditative mind. Clear your workspace, take a few deep breaths, and systematically trace the code with full presence, detaching from frustration or desire for a quick fix.</p>
                    <pre><code>// Debugging with Dhyana (mindful approach):
function debugMindfully(bugReport) { /* ... calm, focused debugging ... */ }
                    </code></pre>
                    <button class="run-challenge-button" onclick="startChallenge('challenge2Output', 'Challenge 2 accepted! Approach your next bug with calm, focused attention (Dhyana). Observe without agitation.')">Begin Challenge</button>
                    <div id="challenge2Output" class="challenge-output"></div>
                </div>

                <div class="challenge-card">
                    <h4>Challenge 3: Vishvarupa Integration</h4>
                    <p>Explore a new API or library completely outside your usual domain. Attempt to integrate a small part of it into a personal project, appreciating its "multifarious forms" and how it expands the universal landscape of technology.</p>
                    <pre><code>// Universal Form Integration (example):
function integrateNewTech(newApi, project) { /* ... explore & integrate ... */ }
                    </code></pre>
                    <button class="run-challenge-button" onclick="startChallenge('challenge3Output', 'Challenge 3 accepted! Broaden your horizons. Appreciate the vastness (Vishvarupa) of technology by exploring something new.')">Begin Challenge</button>
                    <div id="challenge3Output" class="challenge-output"></div>
                </div>
            </div>
        </section>

        <footer>
            <p>&copy; 2025 The Way of Code. All rights reserved. 🪷</p>
        </footer>
    </div>

    <script>
        // --- Three.js Global Variables ---
        let scene, camera, renderer, starfield;
        const planets = []; // For the main solar system
        let mainGalaxy; // For the new spiral galaxy
        let mouseX = 0, mouseY = 0;
        let targetRotationX = 0, targetRotationY = 0;
        let isMouseDown3D = false; 
        let lastMouseX3D = 0, lastMouseY3D = 0; 
        let threeJsInitialized = false; 

        // JavaScript for tab switching
        function showTab(tabId, event) {
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            const activeTab = document.getElementById(tabId);
            if (activeTab) activeTab.classList.add('active');

            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(button => button.classList.remove('active'));
            
            if (event && event.currentTarget) {
                event.currentTarget.classList.add('active');
            } else { 
                const currentButton = document.querySelector(`.tab-button[onclick*="showTab('${tabId}'"]`);
                if (currentButton) currentButton.classList.add('active');
            }
        }

        // JavaScript for sub-navigation (Gita Chapters)
        function showGitaChapter(chapterNum, event) {
            const gitaTabContent = document.getElementById('programmer-gita');
            if (!gitaTabContent) return;

            const chapters = gitaTabContent.querySelectorAll('.content-section');
            chapters.forEach(chapter => chapter.classList.remove('active'));
            const activeChapter = document.getElementById(`chapter${chapterNum}`);
            if (activeChapter) activeChapter.classList.add('active');
            
            const buttons = gitaTabContent.querySelectorAll('.sub-nav-button');
            buttons.forEach(button => button.classList.remove('active'));
             if (event && event.currentTarget) { 
                event.currentTarget.classList.add('active');
            }
        }
        
        // --- JS for Sadhana Sub-Sections ---
        function showSadhanaSubSection(sectionId, event) {
            const sadhanaTabContent = document.getElementById('sadhana');
            if (!sadhanaTabContent) return;

            const sections = sadhanaTabContent.querySelectorAll('.content-section');
            sections.forEach(section => section.classList.remove('active'));
            const activeSection = document.getElementById(sectionId);
            if (activeSection) activeSection.classList.add('active');

            const buttons = sadhanaTabContent.querySelectorAll('.sub-nav-button');
            buttons.forEach(button => button.classList.remove('active'));
            if (event && event.currentTarget) {
                event.currentTarget.classList.add('active');
            }
        }
        
        function handleSadhanaInteraction(outputId, message) {
            const outputBlock = document.getElementById(outputId);
            if (!outputBlock) {
                console.error(`Sadhana output block '${outputId}' not found.`);
                return;
            }
            outputBlock.textContent = message;
            outputBlock.style.backgroundColor = 'rgba(78, 205, 196, 0.2)'; 
            setTimeout(() => { outputBlock.style.backgroundColor = ''; }, 1500);
        }


        // --- JS for Eightfold Path Toggles ---
        function toggleDescription(headerElement, descriptionId) {
            const descriptionDiv = document.getElementById(descriptionId);
            const iconSpan = headerElement.querySelector('.toggle-icon');
            if (descriptionDiv && iconSpan) {
                if (descriptionDiv.style.display === "none" || descriptionDiv.style.display === "") {
                    descriptionDiv.style.display = "block";
                    iconSpan.textContent = "➖";
                } else {
                    descriptionDiv.style.display = "none";
                    iconSpan.textContent = "➕";
                }
            }
        }


        // Floating Lotus Elements
        function initFloatingLotuses() {
            const floatingElementsContainer = document.getElementById('floatingElements');
            if (!floatingElementsContainer) return; 
            floatingElementsContainer.innerHTML = ''; 
            for (let i = 0; i < 10; i++) {
                const lotus = document.createElement('div');
                lotus.className = 'floating-lotus';
                lotus.style.left = `${Math.random() * 100}vw`;
                lotus.style.animationDuration = `${Math.random() * 5 + 5}s`;
                lotus.style.animationDelay = `${Math.random() * 5}s`;
                lotus.textContent = '🪷';
                floatingElementsContainer.appendChild(lotus);
            }
        }
        
        // Conceptual Code Runner
        function runConceptualCode(codeId) {
            const outputBlock = document.getElementById(codeId + 'Output');
            if (!outputBlock) {
                console.error(`Output block for ${codeId}Output not found.`);
                return;
            }
            
            let simulatedOutput = `Simulating insights from ${codeId}... The conceptual code illustrates the chapter's core programming application. Reflect on how these principles can be applied in your daily coding.`;
            
            if (codeId === 'arjunaDilemmaCode') {
                simulatedOutput = "[Dilemma Simulated] Coder Arjuna faces choices: quick fix vs. ethical, sustainable solution. Inner conflict (Vishada) precedes the quest for Dharma (right action). Consider your own project dilemmas and the guiding principles for resolution.";
            } else if (codeId === 'eternalCode') {
                simulatedOutput = "[Eternal Focus Simulated] While frameworks (Temporary/Asat) like FluxCapacitor.js change, principles like Modularity, Abstraction, and Readability (Eternal/Sat) endure. True skill lies in mastering the Sat, applying it through any Asat tool.";
            } else if (codeId === 'karmaYogaCode') {
                simulatedOutput = "[Karma Yoga Simulated] Action performed with full skill and dedication (submitting pull request), but without anxious attachment to the outcome (merge status, praise). This fosters peace and focus on quality of work itself. Contrast with attached action leading to stress.";
            } else if (codeId === 'avatarCode') {
                simulatedOutput = "[Avatar Mission Simulated] Ethical Programmer 'DharmaWarrior' detects digital adharma (bias, privacy issues) and uses knowledge (Jnana) to restore balance. Your skills can be a force for positive change in the tech world.";
            } else if (codeId === 'renunciationCode') {
                simulatedOutput = "[Renunciation Simulated] Coder with high ego struggles to delete 'their' legacy code. Coder practicing Sannyasa (renunciation of attachment) deletes unused code for project health and contributes selflessly, understanding that code flows through, not just from, them.";
            } else if (codeId === 'dhyanaCode') {
                simulatedOutput = "[Mindful Coding Simulated] Yogi Coder prepares by ensuring balance (Yukta Ahara Vihara), sets up a distraction-free environment, achieves one-pointed focus (Ekagram Manah), and enters Flow State (Samadhi in Action) for deep, productive, and joyful coding.";
            } else if (codeId === 'jnanaCode') {
                simulatedOutput = "[Layers Reflected] Software Sage, understanding the 8-fold TechPrakriti (from Hardware 'Earth' to Purpose 'Ego-function'), diagnoses a 'Slow API Response' not just at the framework level but by tracing it to its root in underlying layers. Deep knowledge (Jnana) leads to true solutions (Vijnana).";
            } else if (codeId === 'aksharaCode') {
                simulatedOutput = "[Essence Contemplated] The Factorial Algorithm's core logic (recursive/iterative definition) is Akshara (imperishable). Perishable syntaxes (JS, Python) are mere expressions. Mastering Akshara principles provides lasting competence across changing technologies.";
            } else if (codeId === 'rajaVidyaCode') {
                simulatedOutput = "[Connections Visualized] In system 'MyWebApp', modules (pearls) like AuthService, UserProfileService are interconnected by the Unifying Principle/Sutra (Shared Auth Token & API Gateway). Understanding this Raja Guhyam (secret interconnectedness) is the Raja Vidya (King of Knowledge) for system mastery.";
            } else if (codeId === 'vibhutiCode') {
                simulatedOutput = "[Glories Recognized] Vibhutis (divine excellences) identified: Binary Search's efficiency, Hash Table's rapid access, Python's readability, Modularity's maintainability, Open Source's collaborative power. Recognizing these 'sparks of splendor' inspires striving for excellence.";
            } else if (codeId === 'vishvarupaCode') {
                simulatedOutput = "[Vastness Contemplated] Glimpsing the Universal Form of Technology – from myriad domains like Web Dev & AI, to interconnected layers within, down to countless specific implementations and underlying unifying principles. This vision fosters humility and wonder.";
            } else if (codeId === 'bhaktiCode') {
                simulatedOutput = "[Devotional Coding Simulated] BhaktaDev, the Devotional Coder, fixes mind (Mana) and intellect (Buddhi) on their Ideal of Devotion ('Creating Truly Helpful Software') while coding. The task becomes an offering, performed with love, care, and meticulous attention.";
            } else if (codeId === 'kshetraCode') {
                simulatedOutput = "[Field & Knower Observed] Programmer (Kshetrajna/Knower) observes the LegacyPaymentModule (Kshetra/Field). Distinguishing Self from the code allows objective debugging, free from ego-attachment ('my code failed!') and fostering clearer problem-solving.";
            } else if (codeId === 'gunasCode') {
                simulatedOutput = "[Gunas Analyzed] Coding approach influenced by Sattva (clear, robust), Rajas (fast, messy), and Tamas (buggy, inert). Understanding these Gunas in our mindset and code helps cultivate Sattva for quality and well-being.";
            } else if (codeId === 'purushottamaCode') {
                simulatedOutput = "[Tech Tree Explored] Technology as an Ashvattha tree: Roots (imperishable principles like Computation Theory) are up. Branches (stacks) and Leaves (trendy syntax) are down. Mastery comes from understanding the Roots, not just chasing fleeting Leaves.";
            } else if (codeId === 'divineNatureCode') {
                simulatedOutput = "[Divine/Demoniac Qualities Simulated] Code review scenario shows Daivi (divine: constructive, patient, humble) vs. Asuri (demoniac: arrogant, angry, fault-finding) qualities. Cultivating Daivi Sampad leads to better outcomes and peace.";
            } else if (codeId === 'faithCode') {
                simulatedOutput = "[Faith Assessed] Coders with Sattvic (principle-based), Rajasic (trend-driven), and Tamasic (inertia/superstition-based) faith approach projects differently. Cultivating Sattvic Shraddha (faith in sound, ethical principles) is key.";
            } else if (codeId === 'surrenderCode') {
                simulatedOutput = "[Surrender Simulated] EgoBoundCoder struggles with attachments. SurrenderedCoder, practicing 'Sarva Dharman Parityajya' (abandoning rigid methods/ego) and 'Mam Ekam Sharanam Vraja' (taking refuge in Universal Logic), allows the optimal solution to flow effortlessly.";
            }
            
            outputBlock.textContent = simulatedOutput;
            outputBlock.style.backgroundColor = '#2a3a5a';
            setTimeout(() => { outputBlock.style.backgroundColor = ''; }, 800);
        }
        
        function startChallenge(outputId, message) {
            const outputBlock = document.getElementById(outputId);
            if (!outputBlock) {
                console.error(`Challenge output block '${outputId}' not found.`);
                return;
            }
            outputBlock.textContent = message;
            outputBlock.style.backgroundColor = '#2a3a5a'; 
            setTimeout(() => { outputBlock.style.backgroundColor = ''; }, 1200); 
        }

        function handleReflectionInput(inputId, outputId, messagePrefix) {
            const inputElement = document.getElementById(inputId);
            const outputElement = document.getElementById(outputId);
            if (!inputElement || !outputElement) {
                console.error(`Missing input/output element for ${inputId}/${outputId}`);
                return;
            }
            const inputValue = inputElement.value;
            if (inputValue.trim()) {
                outputElement.textContent = `${messagePrefix}: "${inputValue}"`;
            } else {
                outputElement.textContent = `Please enter your reflection.`;
            }
        }
        function recordDilemma() { handleReflectionInput('dilemmaReflectionInput', 'dilemmaReflectionOutput', 'Dilemma recorded'); }
        function identifyEternalPrinciples() { handleReflectionInput('eternalPrinciplesInput', 'eternalPrinciplesOutput', 'Eternal principles'); }
        function startKarmaYogaChallenge() { handleReflectionInput('karmaYogaChallengeInput', 'karmaYogaChallengeOutput', 'Karma Yoga reflection'); }
        function discoverAvatarMission() { handleReflectionInput('avatarMissionInput', 'avatarMissionOutput', 'Avatar Mission'); }
        function reflectOnRenunciation() { handleReflectionInput('renunciationReflectionInput', 'renunciationReflectionOutput', 'Renunciation reflection'); }
        function startDhyanaChallenge() { handleReflectionInput('dhyanaChallengeInput', 'dhyanaChallengeOutput', 'Dhyana reflection'); }
        function setJnanaGoal() { handleReflectionInput('jnanaReflectionInput', 'jnanaReflectionOutput', 'Knowledge goal'); }
        function reflectOnCoreLogic() { handleReflectionInput('aksharaReflectionInput', 'aksharaReflectionOutput', 'Core logic reflection'); }
        function reflectOnSystem() { handleReflectionInput('rajaVidyaReflectionInput', 'rajaVidyaReflectionOutput', 'System map reflection'); }
        function reflectOnGlories() { handleReflectionInput('vibhutiReflectionInput', 'vibhutiReflectionOutput', 'Code glories reflection'); }
        function setExplorationGoal() { handleReflectionInput('vishvarupaReflectionInput', 'vishvarupaReflectionOutput', 'Exploration goal'); }
        function startBhaktiPractice() { handleReflectionInput('bhaktiReflectionInput', 'bhaktiReflectionOutput', 'Bhakti practice reflection'); }
        function reflectOnKshetra() { handleReflectionInput('kshetraReflectionInput', 'kshetraReflectionOutput', 'Field & Knower reflection'); }
        function reflectOnGunas() { handleReflectionInput('gunasReflectionInput', 'gunasReflectionOutput', 'Guna self-assessment'); }
        function setPurushottamaGoal() { handleReflectionInput('purushottamaReflectionInput', 'purushottamaReflectionOutput', 'Root-learning goal'); }
        function planQualityCultivation() { handleReflectionInput('divineNatureReflectionInput', 'divineNatureReflectionOutput', 'Quality cultivation plan'); }
        function examineProgrammingFaith() { handleReflectionInput('faithReflectionInput', 'faithReflectionOutput', 'Programming faith'); }
        function practiceCompleteSurrender() { handleReflectionInput('surrenderReflectionInput', 'surrenderReflectionOutput', 'Surrender reflection'); }

        // Sadhana Timer (specific for the new Sadhana section timer)
        let sadhanaTimerInterval;
        let sadhanaSeconds = 0; 
        let isSadhanaTimerRunning = false; 
        
        function startSadhanaTimer() {
            if (!isSadhanaTimerRunning) {
                isSadhanaTimerRunning = true;
                sadhanaTimerInterval = setInterval(updateSadhanaTimer, 1000);
                const startBtn = document.getElementById('startTimerButtonSadhana'); if(startBtn) startBtn.disabled = true;
                const pauseBtn = document.getElementById('pauseTimerButtonSadhana'); if(pauseBtn) pauseBtn.disabled = false;
                const resetBtn = document.getElementById('resetTimerButtonSadhana'); if(resetBtn) resetBtn.disabled = false;
            }
        }
        function pauseSadhanaTimer() {
            if (isSadhanaTimerRunning) {
                isSadhanaTimerRunning = false;
                clearInterval(sadhanaTimerInterval);
                const startBtn = document.getElementById('startTimerButtonSadhana'); if(startBtn) startBtn.disabled = false;
                const pauseBtn = document.getElementById('pauseTimerButtonSadhana'); if(pauseBtn) pauseBtn.disabled = true;
            }
        }
        function resetSadhanaTimer() {
            isSadhanaTimerRunning = false;
            clearInterval(sadhanaTimerInterval);
            sadhanaSeconds = 0; 
            updateSadhanaTimerDisplay();
            const startBtn = document.getElementById('startTimerButtonSadhana'); if(startBtn) startBtn.disabled = false;
            const pauseBtn = document.getElementById('pauseTimerButtonSadhana'); if(pauseBtn) pauseBtn.disabled = true;
            const resetBtn = document.getElementById('resetTimerButtonSadhana'); if(resetBtn) resetBtn.disabled = true;
        }
        function updateSadhanaTimer() { sadhanaSeconds++; updateSadhanaTimerDisplay(); }
        function updateSadhanaTimerDisplay() {
            const hours = Math.floor(sadhanaSeconds / 3600);
            const minutes = Math.floor((sadhanaSeconds % 3600) / 60);
            const remainingSeconds = sadhanaSeconds % 60;
            const formattedTime = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(remainingSeconds).padStart(2, '0')}`;
            const timerDisplayElement = document.getElementById('timerDisplaySadhana');
            if (timerDisplayElement) timerDisplayElement.textContent = formattedTime;
        }


        // --- Three.js Solar System Graphics ---
        function init3D() {
            const container = document.getElementById('three-js-canvas-container');
            if (!container) {
                console.error("Three.js canvas container ('three-js-canvas-container') not found.");
                return false;
            }
            const width = container.clientWidth;
            const height = container.clientHeight;
             if (width === 0 || height === 0) { 
                 console.warn("Three.js canvas container has zero dimensions. Animation might not be visible. Ensure it's styled correctly and visible.");
            }

            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, width / Math.max(1, height), 0.1, 3000); // Increased far plane
            camera.position.z = 20; // Adjusted camera position for new scale

            try {
                renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            } catch (e) {
                console.error("Three.js WebGLRenderer could not be initialized. Possibly no WebGL support.", e);
                container.innerHTML = "<p style='color:#ff6b6b;text-align:center;padding-top:50px;'>WebGL not supported. 3D animation cannot load.</p>";
                return false;
            }
            renderer.setSize(width, height);
            container.innerHTML = ''; 
            container.appendChild(renderer.domElement);

            // Background Starfield
            const bgStarGeometry = new THREE.BufferGeometry();
            const bgStarCount = 20000;
            const bgPositions = new Float32Array(bgStarCount * 3);
            const bgColors = new Float32Array(bgStarCount * 3);
            const bgColor = new THREE.Color();
            for (let i = 0; i < bgStarCount; i++) {
                bgPositions[i * 3] = (Math.random() - 0.5) * 2500; // Wider spread for background
                bgPositions[i * 3 + 1] = (Math.random() - 0.5) * 2500;
                bgPositions[i * 3 + 2] = (Math.random() - 0.5) * 2500;
                bgColor.setHSL(Math.random() * 0.1 + 0.6, 0.8, Math.random() * 0.3 + 0.4); // Dimmer, bluer stars
                bgColors[i * 3] = bgColor.r; bgColors[i * 3 + 1] = bgColor.g; bgColors[i * 3 + 2] = bgColor.b;
            }
            bgStarGeometry.setAttribute('position', new THREE.BufferAttribute(bgPositions, 3));
            bgStarGeometry.setAttribute('color', new THREE.BufferAttribute(bgColors, 3));
            const bgStarMaterial = new THREE.PointsMaterial({ size: 0.3, vertexColors: true, transparent: true, opacity: 0.7, blending: THREE.AdditiveBlending });
            starfield = new THREE.Points(bgStarGeometry, bgStarMaterial); // Re-assign starfield to this new one
            scene.add(starfield);

            // Central Sun
            const sunGeometry = new THREE.SphereGeometry(2, 32, 32); 
            const sunMaterial = new THREE.MeshBasicMaterial({ color: 0xFFA500, wireframe: false }); // Orange Sun
            const sun = new THREE.Mesh(sunGeometry, sunMaterial);
            scene.add(sun);
            const sunLight = new THREE.PointLight(0xFFDAB9, 1.8, 700); // PeachPuff light, slightly stronger
            sun.add(sunLight);

            // Planets
            planets.length = 0; 
            const planetDefs = [
                { name: "Mercury", radius: 0.3, color: 0xAAAAAA, orbitRadius: 4, orbitSpeed: 0.0047 },
                { name: "Venus", radius: 0.5, color: 0xFFE4B5, orbitRadius: 6, orbitSpeed: 0.0035 },
                { name: "Earth", radius: 0.55, color: 0x6495ED, secondaryColor: 0x3CB371, orbitRadius: 8.5, orbitSpeed: 0.0029, axialTilt: 0.41 },
                { name: "Mars", radius: 0.4, color: 0xFF6347, orbitRadius: 11.5, orbitSpeed: 0.0024 },
                { name: "Jupiter", radius: 1.2, color: 0xF4A460, orbitRadius: 16, orbitSpeed: 0.0013 },
                { name: "Saturn", radius: 1, color: 0xDAA520, orbitRadius: 21, orbitSpeed: 0.0009, ring: {inner: 1.2, outer: 2.2, color: 0xCEC8B4} },
            ];
            planetDefs.forEach(data => {
                const planetMaterial = new THREE.MeshStandardMaterial({ color: data.color, roughness: 0.7, metalness: 0.2 });
                const planet = new THREE.Mesh(new THREE.SphereGeometry(data.radius, 24, 24), planetMaterial); 
                planet.name = data.name;
                planet.orbitRadius = data.orbitRadius;
                planet.orbitSpeed = data.orbitSpeed;
                planet.axialTilt = data.axialTilt || 0;
                planet.rotation.x = planet.axialTilt; 

                if (data.ring) {
                    const ringGeometry = new THREE.RingGeometry(data.ring.inner, data.ring.outer, 48);
                    const ringMaterial = new THREE.MeshBasicMaterial({ color: data.ring.color, side: THREE.DoubleSide, transparent: true, opacity: 0.5 });
                    const ringMesh = new THREE.Mesh(ringGeometry, ringMaterial);
                    ringMesh.rotation.x = Math.PI / 2 + 0.1; 
                    planet.add(ringMesh); 
                }
                planets.push(planet); 
                scene.add(planet);
            });

            // Create a Spiral Galaxy
            const galaxyParticlesCount = 30000; 
            const galaxyPositions = new Float32Array(galaxyParticlesCount * 3);
            const galaxyColors = new Float32Array(galaxyParticlesCount * 3);
            const galaxyColor = new THREE.Color();
            const galaxyRadius = 150; 
            const arms = 4; 
            const armSpread = 0.5; 
            const coreSize = 10; 

            for (let i = 0; i < galaxyParticlesCount; i++) {
                const r = Math.random() * galaxyRadius; 
                const angle = (i % arms) * (Math.PI * 2 / arms) + Math.pow(r / galaxyRadius, 1.5) * armSpread * Math.PI * 2 + (Math.random()-0.5) * 0.5; 
                const x = Math.cos(angle) * r;
                const z = Math.sin(angle) * r;
                const y = (Math.random() - 0.5) * (galaxyRadius * 0.1) * (1 - r / galaxyRadius); 

                galaxyPositions[i * 3] = x;
                galaxyPositions[i * 3 + 1] = y;
                galaxyPositions[i * 3 + 2] = z;

                const distanceFromCore = Math.sqrt(x*x + y*y + z*z);
                if (distanceFromCore < coreSize) { 
                    galaxyColor.setHSL(0.1 + Math.random() * 0.05, 0.9, 0.6 + Math.random() * 0.2); 
                } else { 
                    galaxyColor.setHSL(0.55 + Math.random() * 0.15, 0.9, 0.5 + Math.random() * 0.25); 
                }
                galaxyColors[i * 3] = galaxyColor.r;
                galaxyColors[i * 3 + 1] = galaxyColor.g;
                galaxyColors[i * 3 + 2] = galaxyColor.b;
            }
            const mainGalaxyGeometry = new THREE.BufferGeometry();
            mainGalaxyGeometry.setAttribute('position', new THREE.BufferAttribute(galaxyPositions, 3));
            mainGalaxyGeometry.setAttribute('color', new THREE.BufferAttribute(galaxyColors, 3));
            const mainGalaxyMaterial = new THREE.PointsMaterial({ size: 0.3, vertexColors: true, transparent: true, opacity: 0.8, blending: THREE.AdditiveBlending });
            mainGalaxy = new THREE.Points(mainGalaxyGeometry, mainGalaxyMaterial);
            mainGalaxy.position.z = -250; 
            mainGalaxy.rotation.x = -Math.PI / 6; 
            scene.add(mainGalaxy);


            // Lights
            scene.add(new THREE.AmbientLight(0x505050)); 
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.7);
            directionalLight.position.set(5,3,5);
            scene.add(directionalLight);


            container.addEventListener('mousedown', onMouseDown3D, false);
            container.addEventListener('mousemove', onMouseMove3D, false);
            container.addEventListener('mouseup', onMouseUp3D, false);
            container.addEventListener('mouseleave', onMouseUp3D, false);
            window.addEventListener('resize', onWindowResize3D, false);
            onWindowResize3D(); 
            threeJsInitialized = true;
            return true;
        }

        function onWindowResize3D() {
            if (!threeJsInitialized || !camera || !renderer) return;
            const container = document.getElementById('three-js-canvas-container');
            if (!container) return;
            const width = container.clientWidth;
            const height = container.clientHeight;
            if (width === 0 || height === 0) return; 
            camera.aspect = width / height;
            camera.updateProjectionMatrix();
            renderer.setSize(width, height);
        }
        function onMouseDown3D(event) { isMouseDown3D = true; lastMouseX3D = event.clientX; lastMouseY3D = event.clientY; }
        function onMouseUp3D() { isMouseDown3D = false; }
        function onMouseMove3D(event) {
            if (!isMouseDown3D ) return; 
            const deltaX = event.clientX - lastMouseX3D; const deltaY = event.clientY - lastMouseY3D;
            targetRotationY += deltaX * 0.005; targetRotationX += deltaY * 0.005;
            targetRotationX = Math.max(-Math.PI / 2, Math.min(Math.PI / 2, targetRotationX)); 
            lastMouseX3D = event.clientX; lastMouseY3D = event.clientY;
        }

        function animate3D() {
            if (!threeJsInitialized || !scene || !camera || !renderer) return; 
            requestAnimationFrame(animate3D);
            
            const time = Date.now() * 0.00005; 

            scene.rotation.y += (targetRotationY - scene.rotation.y) * 0.05; 
            scene.rotation.x += (targetRotationX - scene.rotation.x) * 0.05;
            
            planets.forEach((planet) => {
                const orbitSpeedFactor = 20 / planet.orbitRadius; 
                const angle = time * orbitSpeedFactor * planet.orbitSpeed * 1000 + planet.orbitRadius;
                planet.position.x = Math.cos(angle) * planet.orbitRadius;
                planet.position.z = Math.sin(angle) * planet.orbitRadius;
                planet.rotation.y += 0.01; 
            });

            if(mainGalaxy) {
                mainGalaxy.rotation.y += 0.0002; 
            }

            renderer.render(scene, camera);
        }

        window.onload = function () {
            initFloatingLotuses(); 
            
            const defaultTabButton = document.querySelector('.tab-button[onclick*="showTab(\'sadhana\'"]');
            if (defaultTabButton) {
                 showTab('sadhana', { currentTarget: defaultTabButton });
            }
            const defaultSadhanaButton = document.querySelector('#sadhana .sub-nav-button[onclick*="showSadhanaSubSection(\'sadhana_morning\'"]');
            if (defaultSadhanaButton) {
                showSadhanaSubSection('sadhana_morning', {currentTarget: defaultSadhanaButton });
            }
            updateSadhanaTimerDisplay(); 

            if (typeof THREE !== 'undefined') {
                if (init3D()) { 
                    animate3D();
                }
            } else {
                console.error("Three.js library not loaded. 3D header will not display.");
                const canvasContainer = document.getElementById('three-js-canvas-container');
                if (canvasContainer) canvasContainer.innerHTML = "<p style='color:#ff6b6b;text-align:center;padding-top:50px;'>Three.js library missing. 3D animation cannot be loaded.</p>";
            }
            
            const gitaTab = document.getElementById('programmer-gita');
            if (gitaTab && gitaTab.classList.contains('active')) {
                const defaultGitaChapterButton = gitaTab.querySelector('.sub-nav-button'); 
                if (defaultGitaChapterButton) {
                    showGitaChapter(1, { currentTarget: defaultGitaChapterButton });
                }
            }
        };
    </script>
</body>
</html>
